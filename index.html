<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Builder</title>
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.1/css/all.min.css">
  <style>
    /* ============================================
       Player Builder
       ============================================ */

    /* Reset & Base */
    *, *::before, *::after {
      box-sizing: border-box;
      margin: 0;
      padding: 0;
    }

    html {
      font-size: 16px;
      scroll-behavior: smooth;
    }

    /* ============================================
       CSS VARIABLES - STYLE DEFAULTS
       ============================================ */
    :root {
      /* Primary Colors */
      --player-primary: #3B82F6;
      --player-primary-hover: #2563EB;
      --player-primary-light: #DBEAFE;

      /* Backgrounds */
      --player-bg: #FFFFFF;
      --player-bg-secondary: #F8FAFC;
      --player-bg-tertiary: #F1F5F9;

      /* Text */
      --player-text: #0F172A;
      --player-text-secondary: #64748B;
      --player-text-tertiary: #94A3B8;

      /* Borders & Shadows */
      --player-border: #E2E8F0;
      --player-border-width: 1px;
      --player-radius: 0.75rem;
      --player-radius-sm: 0.5rem;
      --player-radius-full: 9999px;
      --player-shadow: 0 1px 3px rgba(0,0,0,0.08), 0 1px 2px rgba(0,0,0,0.04);
      --player-shadow-lg: 0 10px 40px rgba(0,0,0,0.1), 0 2px 10px rgba(0,0,0,0.05);

      /* Typography */
      --player-font: -apple-system, BlinkMacSystemFont, "Segoe UI", Helvetica, Arial, sans-serif;

      /* Waveform */
      --player-wave-active: var(--player-primary);
      --player-wave-inactive: #CBD5E1;

      /* Transcript */
      --player-transcript-bg: #F1F5F9;

      /* Transitions */
      --player-transition: 0.15s cubic-bezier(0.4, 0, 0.2, 1);
      --player-transition-slow: 0.3s cubic-bezier(0.4, 0, 0.2, 1);

      /* Builder UI Variables */
      --builder-bg: #F8FAFC;
      --builder-surface: #FFFFFF;
      --builder-border: #E2E8F0;
      --builder-text: #0F172A;
      --builder-text-muted: #64748B;
      --builder-accent: #3B82F6;
      --builder-preview-bg: #EFEFEF;
    }

    /* Dark Theme */
    [data-theme="dark"] {
      --player-bg: #0F172A;
      --player-bg-secondary: #1E293B;
      --player-bg-tertiary: #334155;
      --player-text: #F8FAFC;
      --player-text-secondary: #94A3B8;
      --player-text-tertiary: #64748B;
      --player-border: #334155;
      --player-shadow: 0 1px 3px rgba(0,0,0,0.3), 0 1px 2px rgba(0,0,0,0.2);
      --player-shadow-lg: 0 10px 40px rgba(0,0,0,0.4), 0 2px 10px rgba(0,0,0,0.3);
      --player-wave-inactive: #475569;
      --player-primary-light: #1E3A5F;
      --player-transcript-bg: #1E293B;

      --builder-bg: #0F172A;
      --builder-surface: #1E293B;
      --builder-border: #334155;
      --builder-text: #F8FAFC;
      --builder-text-muted: #94A3B8;
      --builder-preview-bg: #2D3748;
    }

    body {
      font-family: var(--player-font);
      background: var(--builder-bg);
      color: var(--builder-text);
      line-height: 1.6;
      min-height: 100vh;
    }

    /* ============================================
       BUILDER LAYOUT
       ============================================ */
    .builder {
      max-width: 1400px;
      margin: 0 auto;
      padding: 2rem;
    }

    .builder__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1.5rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--builder-border);
    }

    .builder__title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--builder-text);
    }

    .theme-toggle {
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 0.5rem;
      border: 1px solid var(--builder-border);
      background: var(--builder-surface);
      color: var(--builder-text-muted);
      cursor: pointer;
      display: flex;
      align-items: center;
      justify-content: center;
      transition: all var(--player-transition);
    }

    .theme-toggle:hover {
      border-color: var(--builder-accent);
      color: var(--builder-accent);
    }

    .theme-toggle .fa-sun { display: none; }
    [data-theme="dark"] .theme-toggle .fa-moon { display: none; }
    [data-theme="dark"] .theme-toggle .fa-sun { display: block; }

    /* Main Content Grid */
    .builder__content {
      display: grid;
      grid-template-columns: 400px 1fr;
      gap: 2rem;
      align-items: start;
    }

    /* ============================================
       CONTROLS PANEL
       ============================================ */
    .controls {
      background: var(--builder-surface);
      border: 1px solid var(--builder-border);
      border-radius: 1rem;
      overflow: hidden;
    }

    .controls__step {
      border-bottom: 1px solid var(--builder-border);
    }

    .controls__step:last-child {
      border-bottom: none;
    }

    .controls__step-header {
      display: flex;
      align-items: center;
      gap: 0.75rem;
      padding: 1rem 1.25rem;
      background: var(--builder-bg);
      cursor: pointer;
      user-select: none;
      transition: background var(--player-transition);
    }

    .controls__step-header:hover {
      background: var(--player-bg-tertiary);
    }

    .controls__step-number {
      width: 1.75rem;
      height: 1.75rem;
      border-radius: 50%;
      background: var(--builder-accent);
      color: white;
      font-size: 0.75rem;
      font-weight: 600;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .controls__step-title {
      flex: 1;
      font-size: 0.9375rem;
      font-weight: 600;
    }

    .controls__step-toggle {
      color: var(--builder-text-muted);
      transition: transform var(--player-transition);
    }

    .controls__step.is-collapsed .controls__step-toggle {
      transform: rotate(-90deg);
    }

    .controls__step-content {
      padding: 1rem 1.25rem 1.25rem;
    }

    .controls__step.is-collapsed .controls__step-content {
      display: none;
    }

    /* Control Groups */
    .control-row {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
      margin-bottom: 1rem;
    }

    .control-row:last-child {
      margin-bottom: 0;
    }

    .control-row--full {
      grid-template-columns: 1fr;
    }

    .control-row--triple {
      grid-template-columns: repeat(3, 1fr);
    }

    .control-group {
      display: flex;
      flex-direction: column;
      gap: 0.375rem;
    }

    .control-group label {
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--builder-text-muted);
      text-transform: uppercase;
      letter-spacing: 0.3px;
    }

    /* Color Input */
    .color-input {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      padding: 0.375rem 0.625rem;
      background: var(--builder-bg);
      border: 1px solid var(--builder-border);
      border-radius: 0.5rem;
      transition: border-color var(--player-transition);
    }

    .color-input:hover,
    .color-input:focus-within {
      border-color: var(--builder-accent);
    }

    .color-input input[type="color"] {
      width: 1.5rem;
      height: 1.5rem;
      border: none;
      border-radius: 0.25rem;
      cursor: pointer;
      padding: 0;
      background: none;
    }

    .color-input input[type="color"]::-webkit-color-swatch-wrapper {
      padding: 0;
    }

    .color-input input[type="color"]::-webkit-color-swatch {
      border: 1px solid var(--builder-border);
      border-radius: 0.25rem;
    }

    .color-input .color-value {
      font-size: 0.75rem;
      font-family: monospace;
      color: var(--builder-text-muted);
      text-transform: uppercase;
    }

    .checkbox-label {
      display: flex;
      align-items: center;
      gap: 0.5rem;
      font-size: 0.8125rem;
      color: var(--builder-text);
      cursor: pointer;
    }

    .checkbox-label input[type="checkbox"] {
      width: 1rem;
      height: 1rem;
      accent-color: var(--builder-accent);
      cursor: pointer;
    }

    /* Select Input */
    .select-input {
      padding: 0.5rem 2rem 0.5rem 0.75rem;
      font-size: 0.8125rem;
      font-family: inherit;
      border: 1px solid var(--builder-border);
      border-radius: 0.5rem;
      background: var(--builder-bg);
      color: var(--builder-text);
      cursor: pointer;
      appearance: none;
      background-image: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' width='12' height='12' viewBox='0 0 24 24' fill='none' stroke='%236b7280' stroke-width='2'%3E%3Cpath d='M6 9l6 6 6-6'/%3E%3C/svg%3E");
      background-repeat: no-repeat;
      background-position: right 0.5rem center;
      transition: border-color var(--player-transition);
    }

    .select-input:hover,
    .select-input:focus {
      border-color: var(--builder-accent);
      outline: none;
    }

    /* Player Type Tabs */
    .player-tabs {
      display: flex;
      gap: 0.5rem;
      flex-wrap: wrap;
    }

    .player-tab {
      flex: 1;
      min-width: 70px;
      padding: 0.625rem 0.75rem;
      border: 1px solid var(--builder-border);
      border-radius: 0.5rem;
      background: var(--builder-bg);
      color: var(--builder-text-muted);
      font-size: 0.8125rem;
      font-weight: 500;
      cursor: pointer;
      transition: all var(--player-transition);
      text-align: center;
    }

    .player-tab:hover {
      border-color: var(--builder-accent);
      color: var(--builder-text);
    }

    .player-tab.is-active {
      background: var(--builder-accent);
      border-color: var(--builder-accent);
      color: white;
    }

    /* Player Options Panels */
    .player-options {
      display: none;
    }

    .player-options.is-active {
      display: block;
    }

    /* Options Group */
    .options-group {
      margin-bottom: 1.25rem;
      padding-bottom: 1rem;
      border-bottom: 1px solid var(--builder-border);
    }

    .options-group:last-child {
      margin-bottom: 0;
      padding-bottom: 0;
      border-bottom: none;
    }

    .options-group__title {
      font-size: 0.6875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--builder-text-muted);
      margin-bottom: 0.75rem;
    }

    /* Range Input */
    .range-input {
      width: 100%;
      height: 6px;
      border-radius: 3px;
      background: var(--builder-border);
      appearance: none;
      cursor: pointer;
    }

    .range-input::-webkit-slider-thumb {
      appearance: none;
      width: 16px;
      height: 16px;
      border-radius: 50%;
      background: var(--builder-accent);
      cursor: pointer;
      transition: transform 0.15s ease;
    }

    .range-input::-webkit-slider-thumb:hover {
      transform: scale(1.1);
    }

    /* Text/Number Input */
    .text-input {
      width: 100%;
      padding: 0.5rem 0.75rem;
      font-size: 0.8125rem;
      font-family: inherit;
      border: 1px solid var(--builder-border);
      border-radius: 0.5rem;
      background: var(--builder-bg);
      color: var(--builder-text);
      transition: border-color var(--player-transition);
    }

    .text-input:hover,
    .text-input:focus {
      border-color: var(--builder-accent);
      outline: none;
    }

    /* ============================================
       PREVIEW PANEL
       ============================================ */
    .preview {
      position: sticky;
      top: 2rem;
    }

    .preview__header {
      display: flex;
      align-items: center;
      justify-content: space-between;
      margin-bottom: 1rem;
    }

    .preview__title {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--builder-text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    /* Responsive Preview Container */
    .responsive-preview {
      margin-bottom: 2rem;
      max-width: 77.5rem;
    }

    .responsive-preview__wrapper {
      display: flex;
      align-items: center;
      width: fit-content;
    }

    .responsive-preview__container {
      position: relative;
      display: flex;
      flex-direction: column;
      background: var(--builder-preview-bg);
      border: 1px solid var(--builder-border);
      border-radius: 0.75rem;
      overflow: hidden;
      min-height: 6rem;
      transition: width 0.3s ease;
      width: 75rem;
      max-width: 75rem;
      box-shadow: 0 1px 3px rgba(0,0,0,0.05);
    }

    /* Breakpoint Ruler */
    .responsive-preview__ruler {
      position: relative;
      background: var(--builder-bg);
      border-bottom: 1px solid var(--builder-border);
      height: 2rem;
      overflow: hidden;
    }

    .responsive-preview__breakpoint {
      position: absolute;
      top: 0;
      height: 100%;
      display: flex;
      align-items: center;
      padding-left: 0.75rem;
      border-left: 1px solid var(--builder-border);
      cursor: pointer;
      transition: background 0.2s ease;
      z-index: 2;
    }

    .responsive-preview__breakpoint[data-bp="mobile"] {
      border-left: none;
    }

    .responsive-preview__breakpoint:hover .responsive-preview__bp-label {
      color: var(--builder-text);
    }

    .responsive-preview__bp-label {
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--builder-text-muted);
      white-space: nowrap;
    }

    .responsive-preview__indicator {
      position: absolute;
      top: 0;
      bottom: 0;
      left: 0;
      background: var(--builder-surface);
      pointer-events: none;
      transition: width 0.1s ease;
      z-index: 1;
    }

    .responsive-preview__content {
      flex: 1;
      padding: 1.5rem;
      overflow: hidden;
      display: flex;
      align-items: center;
      justify-content: center;
    }

    .responsive-preview__content .player-full {
      width: 100%;
      max-width: none;
    }

    .responsive-preview__handle {
      width: 1.25rem;
      background: transparent;
      cursor: ew-resize;
      display: flex;
      align-items: center;
      justify-content: center;
      flex-shrink: 0;
      margin-left: 0.75rem;
    }

    .responsive-preview__handle:hover .responsive-preview__handle-bar {
      opacity: 0.8;
      transform: scaleY(1.1);
    }

    .responsive-preview__handle-bar {
      width: 4px;
      height: 2.5rem;
      background: var(--builder-border);
      border-radius: 2px;
      opacity: 0.6;
      transition: opacity 0.2s ease, transform 0.2s ease;
    }

    .responsive-preview__width {
      margin-top: 0.5rem;
      text-align: center;
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--builder-text-muted);
      font-family: 'SF Mono', 'Monaco', 'Inconsolata', monospace;
    }

    /* Non-Full Player Preview */
    .preview__container {
      padding: 2rem;
      min-height: 200px;
      display: flex;
      align-items: center;
      justify-content: center;
      background: var(--builder-preview-bg);
      border: 1px solid var(--builder-border);
      border-radius: 0.75rem;
      transition: background var(--player-transition);
    }

    .preview__player {
      width: 100%;
      max-width: 500px;
      display: flex;
      flex-direction: column;
      align-items: center;
      justify-content: center;
    }

    /* Mini Player Preview */
    .preview__mini-wrapper {
      width: 100%;
      max-width: 20rem;
      aspect-ratio: 1;
      background: url('https://upload.wikimedia.org/wikipedia/commons/thumb/e/ec/Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg/800px-Mona_Lisa%2C_by_Leonardo_da_Vinci%2C_from_C2RMF_retouched.jpg') center/cover;
      border-radius: 1rem;
      position: relative;
      overflow: hidden;
    }

    /* ============================================
       EXAMPLES SECTION
       ============================================ */
    .examples-section {
      margin-top: 2rem;
    }

    .examples-section__header {
      margin-bottom: 1rem;
    }

    .examples-section__title {
      font-size: 0.875rem;
      font-weight: 600;
      color: var(--builder-text-muted);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .examples-grid {
      display: grid;
      grid-template-columns: repeat(2, 1fr);
      gap: 1rem;
    }

    .example-card {
      background: var(--builder-bg);
      border: 1px solid var(--builder-border);
      border-radius: 0.75rem;
      overflow: hidden;
    }

    .example-card__label {
      padding: 0.5rem 0.75rem;
      font-size: 0.75rem;
      font-weight: 500;
      color: var(--builder-text-muted);
      border-bottom: 1px solid var(--builder-border);
      background: var(--builder-bg-secondary);
    }

    .example-card__preview {
      padding: 1rem;
      min-height: 180px;
      background: var(--builder-preview-bg);
    }

    .example-card__preview--dark {
      background: #1a1a2e;
    }

    /* Example Player Wrappers */
    .example-player-wrapper {
      margin: 0.75rem 0;
    }

    .example-player {
      transform: scale(0.85);
      transform-origin: left center;
    }

    .example-player--full {
      width: 100%;
    }

    .example-player--pill {
      transform: scale(0.9);
    }

    .example-waveform,
    .example-waveform-pill {
      display: flex;
      align-items: center;
      gap: 2px;
    }

    /* Full Player Examples */
    .example-article {
      width: 100%;
    }

    .example-article__text {
      font-size: 0.7rem;
      line-height: 1.5;
      color: var(--builder-text-muted);
      margin: 0;
    }

    /* Podcast Example */
    .example-podcast {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .example-podcast__art {
      width: 56px;
      height: 56px;
      border-radius: 0.5rem;
      object-fit: cover;
    }

    .example-podcast__info {
      display: flex;
      flex-direction: column;
      gap: 0.125rem;
    }

    .example-podcast__title {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--builder-text);
      margin: 0;
    }

    .example-podcast__meta {
      font-size: 0.65rem;
      color: var(--builder-text-muted);
      margin: 0;
    }

    /* Course Example */
    .example-course {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .example-course__header {
      display: flex;
      flex-direction: column;
      gap: 0.125rem;
    }

    .example-course__lesson {
      font-size: 0.6rem;
      color: var(--player-primary);
      text-transform: uppercase;
      letter-spacing: 0.5px;
    }

    .example-course__title {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--builder-text);
      margin: 0;
    }

    .example-course__nav {
      display: flex;
      justify-content: space-between;
      gap: 0.5rem;
      margin-top: 0.25rem;
    }

    .example-course__btn {
      padding: 0.35rem 0.6rem;
      font-size: 0.6rem;
      border: 1px solid var(--builder-border);
      background: var(--builder-bg);
      color: var(--builder-text-muted);
      border-radius: 0.25rem;
      cursor: pointer;
      display: flex;
      align-items: center;
      gap: 0.25rem;
    }

    .example-course__btn--primary {
      background: var(--player-primary);
      border-color: var(--player-primary);
      color: white;
    }

    /* Landing Example */
    .example-landing {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
      align-items: center;
      text-align: center;
    }

    .example-landing__hero {
      display: flex;
      flex-direction: column;
      align-items: center;
      gap: 0.25rem;
    }

    .example-landing__title {
      font-size: 0.9rem;
      font-weight: 700;
      color: var(--builder-text);
      margin: 0;
    }

    .example-landing__subtitle {
      font-size: 0.65rem;
      color: var(--builder-text-muted);
      margin: 0;
    }

    /* Mini Player Examples */
    .example-artwork {
      width: 100%;
      position: relative;
      border-radius: 0.5rem;
      overflow: hidden;
    }

    .example-artwork__image {
      width: 100%;
      height: 140px;
      object-fit: cover;
      display: block;
    }

    .example-artwork__overlay {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 0.75rem;
      background: linear-gradient(transparent, rgba(0,0,0,0.8));
      display: flex;
      align-items: flex-end;
      justify-content: space-between;
    }

    .example-artwork__info {
      color: white;
    }

    .example-artwork__title {
      font-size: 0.75rem;
      font-weight: 600;
      margin: 0;
    }

    .example-artwork__artist {
      font-size: 0.6rem;
      opacity: 0.8;
      margin: 0;
    }

    .example-mini-player {
      width: 44px !important;
      height: 44px !important;
      position: relative !important;
      flex-shrink: 0;
      cursor: pointer;
      /* Override absolute positioning for examples */
      transform: none !important;
      top: auto !important;
      left: auto !important;
      bottom: auto !important;
      right: auto !important;
      /* Ensure flex centering for icon */
      display: flex !important;
      align-items: center;
      justify-content: center;
    }

    .example-mini-player--sm {
      width: 36px !important;
      height: 36px !important;
    }

    .example-mini-player--float {
      position: absolute !important;
      bottom: 0.75rem !important;
      right: 0.75rem !important;
      top: auto !important;
      left: auto !important;
      box-shadow: 0 4px 12px rgba(0,0,0,0.3);
    }

    /* Scale down progress ring for example mini players */
    .example-mini-player .player-mini__progress-ring {
      inset: -3px;
    }

    .example-mini-player .player-mini__icon {
      width: 1.25rem !important;
      height: 1.25rem !important;
    }

    /* Product Card Example */
    .example-product {
      width: 100%;
      display: flex;
      align-items: flex-start;
      gap: 0.75rem;
    }

    .example-product__image {
      width: 64px;
      height: 64px;
      border-radius: 0.5rem;
      object-fit: cover;
    }

    .example-product__info {
      flex: 1;
      min-width: 0;
    }

    .example-product__name {
      font-size: 0.75rem;
      font-weight: 600;
      color: var(--builder-text);
      margin: 0 0 0.125rem;
    }

    .example-product__price {
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--player-primary);
      margin: 0 0 0.25rem;
    }

    .example-product__desc {
      font-size: 0.6rem;
      color: var(--builder-text-muted);
      margin: 0;
      line-height: 1.4;
    }

    /* Profile Card Example */
    .example-profile {
      width: 100%;
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .example-profile__avatar {
      width: 48px;
      height: 48px;
      border-radius: 50%;
      object-fit: cover;
    }

    .example-profile__info {
      flex: 1;
      min-width: 0;
    }

    .example-profile__name {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--builder-text);
      margin: 0;
    }

    .example-profile__role {
      font-size: 0.65rem;
      color: var(--builder-text-muted);
      margin: 0;
    }

    /* Audio Guide Example */
    .example-guide {
      width: 100%;
      position: relative;
    }

    .example-guide__image {
      width: 100%;
      height: 110px;
      object-fit: cover;
      border-radius: 0.5rem;
    }

    .example-guide__content {
      position: absolute;
      bottom: 0;
      left: 0;
      right: 0;
      padding: 0.75rem;
      background: linear-gradient(transparent, rgba(0,0,0,0.85));
      border-radius: 0 0 0.5rem 0.5rem;
      color: white;
    }

    .example-guide__number {
      font-size: 0.55rem;
      text-transform: uppercase;
      letter-spacing: 1px;
      opacity: 0.8;
    }

    .example-guide__title {
      font-size: 0.75rem;
      font-weight: 600;
      margin: 0.125rem 0 0;
    }

    /* Pill Player Examples */
    .example-chat {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .example-chat__message {
      max-width: 85%;
      padding: 0.5rem 0.65rem;
      border-radius: 0.75rem;
      font-size: 0.65rem;
      line-height: 1.4;
    }

    .example-chat__message p {
      margin: 0;
    }

    .example-chat__message--them {
      background: var(--builder-border);
      color: var(--builder-text);
      align-self: flex-start;
      border-bottom-left-radius: 0.25rem;
    }

    .example-chat__message--me {
      background: var(--player-primary);
      color: white;
      align-self: flex-end;
      border-bottom-right-radius: 0.25rem;
      padding: 0.35rem;
    }

    .example-chat__message--me .player-pill {
      background: rgba(255,255,255,0.15);
      border-color: rgba(255,255,255,0.2);
    }

    /* Social Bio Example */
    .example-bio {
      width: 100%;
      display: flex;
      flex-direction: column;
      align-items: center;
      text-align: center;
      gap: 0.35rem;
    }

    .example-bio__avatar {
      width: 52px;
      height: 52px;
      border-radius: 50%;
      object-fit: cover;
    }

    .example-bio__name {
      font-size: 0.85rem;
      font-weight: 600;
      color: var(--builder-text);
      margin: 0;
    }

    .example-bio__handle {
      font-size: 0.65rem;
      color: var(--builder-text-muted);
      margin: 0;
    }

    .example-bio__desc {
      font-size: 0.6rem;
      color: var(--builder-text-muted);
      margin: 0;
      line-height: 1.4;
    }

    .example-bio__player {
      margin-top: 0.5rem;
      width: 100%;
      max-width: 180px;
    }

    /* Voice Note Example */
    .example-note {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.5rem;
    }

    .example-note__header {
      display: flex;
      justify-content: space-between;
      align-items: flex-start;
    }

    .example-note__title {
      font-size: 0.8rem;
      font-weight: 600;
      color: var(--builder-text);
      margin: 0;
    }

    .example-note__date {
      font-size: 0.6rem;
      color: var(--builder-text-muted);
      margin: 0.125rem 0 0;
    }

    .example-note__menu {
      color: var(--builder-text-muted);
      font-size: 0.75rem;
    }

    .example-note__text {
      font-size: 0.65rem;
      color: var(--builder-text-muted);
      line-height: 1.5;
      margin: 0;
    }

    /* Testimonial Example */
    .example-testimonial {
      width: 100%;
      display: flex;
      flex-direction: column;
      gap: 0.75rem;
    }

    .example-testimonial__quote {
      font-size: 0.7rem;
      font-style: italic;
      color: var(--builder-text);
      line-height: 1.5;
      margin: 0;
    }

    .example-testimonial__author {
      display: flex;
      align-items: center;
      gap: 0.5rem;
    }

    .example-testimonial__avatar {
      width: 32px;
      height: 32px;
      border-radius: 50%;
      object-fit: cover;
    }

    .example-testimonial__name {
      font-size: 0.7rem;
      font-weight: 600;
      color: var(--builder-text);
      margin: 0;
    }

    .example-testimonial__role {
      font-size: 0.6rem;
      color: var(--builder-text-muted);
      margin: 0;
    }

    /* ============================================
       PLAYER COMPONENTS
       ============================================ */

    /* Full Player */
    .player-full {
      width: 100%;
      background: var(--player-bg);
      border: 1px solid var(--player-border);
      border-radius: var(--player-radius);
      overflow: hidden;
    }

    .player-full__main {
      padding: 1rem;
    }

    .player-full__controls {
      display: flex;
      align-items: center;
      gap: 0.75rem;
    }

    .player-full__play {
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      background: var(--player-primary);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all 0.15s ease;
      flex-shrink: 0;
    }

    .player-full__play:hover {
      background: var(--player-primary-hover);
      transform: scale(1.05);
    }

    .player-full__play-icon {
      font-size: 0.875rem;
      color: white;
    }

    .player-full__play-icon--play {
      margin-left: 2px;
    }

    .player-full__play-icon--pause {
      display: none;
    }

    .player-full.is-playing .player-full__play-icon--play {
      display: none;
    }

    .player-full.is-playing .player-full__play-icon--pause {
      display: block;
    }

    .player-full__waveform {
      display: flex;
      align-items: center;
      gap: 2px;
      height: 2rem;
      flex: 1;
      min-width: 0;
      overflow: hidden;
      cursor: pointer;
    }

    .player-full__wave-bar {
      width: 4px;
      background: var(--player-wave-inactive);
      border-radius: 2px;
      transition: background 0.15s ease;
      flex-shrink: 0;
    }

    .player-full__wave-bar.is-active {
      background: var(--player-wave-active);
    }

    /* Waveform - Bars */
    .player-full__waveform--bars {
      display: flex;
      align-items: center;
      gap: 2px;
    }

    /* Waveform - Dots */
    .player-full__waveform--dots {
      display: flex;
      align-items: center;
      gap: 4px;
    }

    .player-full__wave-dot {
      width: 4px;
      height: 4px;
      border-radius: 50%;
      background: var(--player-wave-inactive);
      transition: background 0.15s ease;
    }

    .player-full__wave-dot.is-active {
      background: var(--player-wave-active);
    }

    /* Waveform - Smooth */
    .player-full__waveform--smooth {
      flex: 1;
      height: 2rem;
    }

    .player-full__waveform--smooth svg {
      width: 100%;
      height: 100%;
    }

    .waveform-smooth-bg {
      fill: none;
      stroke: var(--player-wave-inactive);
      stroke-width: 3;
      stroke-linecap: round;
    }

    .waveform-smooth-fill {
      fill: none;
      stroke: var(--player-wave-active);
      stroke-width: 3;
      stroke-linecap: round;
      stroke-dasharray: 200;
      stroke-dashoffset: 200; /* Start fully hidden */
    }

    /* Waveform - Line */
    .player-full__waveform--line {
      flex: 1;
      height: 2rem;
    }

    .player-full__waveform--line svg {
      width: 100%;
      height: 100%;
    }

    .waveform-line-bg {
      fill: none;
      stroke: var(--player-wave-inactive);
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
    }

    .waveform-line-fill {
      fill: none;
      stroke: var(--player-wave-active);
      stroke-width: 2;
      stroke-linecap: round;
      stroke-linejoin: round;
      stroke-dasharray: 300;
      stroke-dashoffset: 300; /* Start fully hidden */
    }

    /* Waveform - Blob */
    .player-full__waveform--blob {
      flex: 1;
      height: 2rem;
    }

    .player-full__waveform--blob svg {
      width: 100%;
      height: 100%;
    }

    .blob-bg {
      fill: var(--player-wave-inactive);
    }

    .blob-fill {
      fill: var(--player-wave-active);
      clip-path: inset(0 100% 0 0); /* Start fully hidden */
    }

    /* Waveform - Progress */
    .player-full__waveform--progress {
      flex: 1;
      display: flex;
      align-items: center;
    }

    .waveform-progress-track {
      flex: 1;
      height: 4px;
      background: var(--player-wave-inactive);
      border-radius: 2px;
      overflow: hidden;
    }

    .waveform-progress-fill {
      width: 0%; /* Start at 0 */
      height: 100%;
      background: var(--player-wave-active);
      border-radius: 2px;
    }

    /* Transcript Section */
    .player-full__transcript-section {
      padding: 0.75rem 1rem;
      background: var(--player-transcript-bg);
      border-top: 1px solid var(--player-border);
    }

    .player-full__transcript-label {
      font-size: 0.6875rem;
      font-weight: 600;
      text-transform: uppercase;
      letter-spacing: 0.5px;
      color: var(--player-text-secondary);
      margin-bottom: 0.375rem;
    }

    .player-full__transcript-text {
      font-size: 0.875rem;
      color: var(--player-text);
      line-height: 1.5;
      display: -webkit-box;
      -webkit-line-clamp: 2;
      -webkit-box-orient: vertical;
      overflow: hidden;
    }

    .player-full__transcript-text.is-expanded {
      display: block;
      -webkit-line-clamp: unset;
      overflow: visible;
    }

    .player-full__transcript-more {
      font-size: 0.75rem;
      color: var(--player-primary);
      text-decoration: none;
      margin-top: 0.25rem;
      display: inline-block;
      cursor: pointer;
    }

    .player-full__transcript-more:hover {
      text-decoration: underline;
    }

    .player-full__timer {
      font-size: 0.8125rem;
      color: var(--player-text-secondary);
      display: flex;
      gap: 0.25rem;
      flex-shrink: 0;
    }

    .player-full__timer-current {
      color: var(--player-text);
      font-weight: 500;
    }

    /* Mini Player */
    .player-mini {
      position: absolute;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      transition: all var(--player-transition);
    }

    .player-mini:hover {
      transform: scale(1.06);
    }

    .player-mini:active {
      transform: scale(0.98);
    }

    /* Progress Ring - CSS-based, follows any border-radius */
    .player-mini__progress-ring {
      position: absolute;
      inset: -4px;
      border-radius: inherit;
      pointer-events: none;
    }

    /* Track - full ring in border color */
    .player-mini__progress-track {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      padding: 3px;
      background: var(--player-border);
      -webkit-mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
    }

    /* Fill - progress portion in primary color */
    .player-mini__progress-fill {
      position: absolute;
      inset: 0;
      border-radius: inherit;
      padding: 3px;
      background: conic-gradient(var(--player-primary) 0deg, transparent 0deg);
      -webkit-mask:
        linear-gradient(#fff 0 0) content-box,
        linear-gradient(#fff 0 0);
      -webkit-mask-composite: xor;
      mask-composite: exclude;
    }

    /* Hide progress ring when disabled */
    .player-mini__progress-ring.hidden {
      display: none;
    }

    /* Pulse animation - uses pseudo-element for the expanding ring */
    .player-mini.player-mini--pulse {
      position: relative;
    }

    .player-mini.player-mini--pulse::before {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: inherit;
      background: var(--player-primary);
      opacity: 0;
      transform: scale(1);
      pointer-events: none;
      z-index: -1;
    }

    .player-mini.player-mini--pulse.is-playing::before {
      animation: mini-pulse-ring 1.5s ease-out infinite;
    }

    @keyframes mini-pulse-ring {
      0% {
        transform: scale(1);
        opacity: 0.6;
      }
      100% {
        transform: scale(1.8);
        opacity: 0;
      }
    }

    /* Pulse Rings animation - multiple concentric rings */
    .player-mini.player-mini--rings {
      position: relative;
    }

    .player-mini.player-mini--rings::before,
    .player-mini.player-mini--rings::after {
      content: '';
      position: absolute;
      inset: 0;
      border-radius: inherit;
      border: 2px solid var(--player-primary);
      opacity: 0;
      transform: scale(1);
      pointer-events: none;
      z-index: -1;
    }

    .player-mini.player-mini--rings.is-playing::before {
      animation: mini-rings 2s ease-out infinite;
    }

    .player-mini.player-mini--rings.is-playing::after {
      animation: mini-rings 2s ease-out infinite 0.6s;
    }

    @keyframes mini-rings {
      0% {
        transform: scale(1);
        opacity: 0.8;
      }
      100% {
        transform: scale(2.2);
        opacity: 0;
      }
    }

    .player-mini__icon {
      color: white;
      fill: white;
      transition: all var(--player-transition);
      width: 1.5rem;
      height: 1.5rem;
      flex-shrink: 0;
    }

    .player-mini .player-mini__icon--play {
      display: block;
      margin-left: 0.1875rem;
    }

    .player-mini .player-mini__icon--pause {
      display: none;
    }

    #mini-player.is-playing .player-mini__icon--play {
      display: none !important;
    }

    #mini-player.is-playing .player-mini__icon--pause {
      display: block !important;
    }

    /* Mini Sizes */
    .player-mini--lg { width: 4.5rem; height: 4.5rem; }
    .player-mini--lg .player-mini__icon { width: 2rem !important; height: 2rem !important; }
    .player-mini--md { width: 3.5rem; height: 3.5rem; }
    .player-mini--md .player-mini__icon { width: 1.5rem !important; height: 1.5rem !important; }
    .player-mini--sm { width: 2.5rem; height: 2.5rem; }
    .player-mini--sm .player-mini__icon { width: 1rem !important; height: 1rem !important; }

    /* Mini Positions */
    .player-mini--center { top: 50%; left: 50%; transform: translate(-50%, -50%); }
    .player-mini--center:hover { transform: translate(-50%, -50%) scale(1.08); }
    .player-mini--center:active { transform: translate(-50%, -50%) scale(0.95); }
    .player-mini--bottom-left { bottom: 0.75rem; left: 0.75rem; }
    .player-mini--bottom-center { bottom: 0.75rem; left: 50%; transform: translateX(-50%); }
    .player-mini--bottom-center:hover { transform: translateX(-50%) scale(1.08); }
    .player-mini--bottom-center:active { transform: translateX(-50%) scale(0.95); }
    .player-mini--bottom-right { bottom: 0.75rem; right: 0.75rem; }

    /* Mini player styling comes from Brand Theme button options */

    /* Pill Player */
    .player-pill {
      display: inline-flex;
      align-items: center;
      gap: 0.625rem;
      padding: 0.375rem 0.875rem 0.375rem 0.375rem;
      height: 2.75rem;
      width: auto;
      background: var(--player-bg);
      border: 1px solid var(--player-border);
      border-radius: 9999px;
    }

    .player-pill__play {
      width: 2rem;
      height: 2rem;
      border-radius: 50%;
      background: var(--player-primary);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      flex-shrink: 0;
    }

    .player-pill__play-icon {
      font-size: 0.75rem;
      color: white;
      margin-left: 2px;
    }

    .player-pill__waveform {
      display: flex;
      align-items: center;
      gap: 2px;
      height: 1rem;
      width: auto;
      flex-shrink: 0;
    }

    /* When pill uses progress waveform, allow it to expand */
    .player-pill__waveform.player-full__waveform--progress {
      flex: 1;
      min-width: 60px;
    }

    /* When pill uses SVG-based waveforms, set a fixed width */
    .player-pill__waveform.player-full__waveform--smooth,
    .player-pill__waveform.player-full__waveform--line,
    .player-pill__waveform.player-full__waveform--blob {
      width: 80px;
      flex-shrink: 0;
    }

    .player-pill__waveform.player-full__waveform--smooth svg,
    .player-pill__waveform.player-full__waveform--line svg,
    .player-pill__waveform.player-full__waveform--blob svg {
      width: 100%;
      height: 100%;
    }

    .player-pill__wave-bar {
      width: 2px;
      background: var(--player-wave-inactive);
      border-radius: 1px;
    }

    .player-pill__wave-bar.is-active {
      background: var(--player-wave-active);
    }

    .player-pill__wave-dot {
      width: 4px;
      height: 4px;
      background: var(--player-wave-inactive);
      border-radius: 50%;
    }

    .player-pill__wave-dot.is-active {
      background: var(--player-wave-active);
    }

    .player-pill__timer {
      font-size: 0.75rem;
      color: var(--player-text-secondary);
      flex-shrink: 0;
    }

    /* Pill Progress Bar */
    .player-pill__progress {
      flex: 1;
      height: 4px;
      background: var(--player-wave-inactive);
      border-radius: 2px;
      overflow: hidden;
    }

    .player-pill__progress-fill {
      height: 100%;
      background: var(--player-wave-active);
      border-radius: 2px;
    }

    /* Pill Style Variations */
    .player-pill--light {
      background: var(--player-primary-light);
      border-color: transparent;
    }

    .player-pill--solid {
      background: var(--player-primary);
      border-color: transparent;
    }

    .player-pill--solid .player-pill__play {
      background: rgba(255,255,255,0.2);
    }

    .player-pill--solid .player-pill__timer {
      color: rgba(255,255,255,0.8);
    }

    .player-pill--solid .player-pill__wave-bar {
      background: rgba(255,255,255,0.4);
    }

    .player-pill--solid .player-pill__wave-bar.is-active {
      background: white;
    }

    .player-pill--outline {
      background: transparent;
      border: 2px solid var(--player-primary);
    }

    .player-pill--outline .player-pill__timer {
      color: var(--player-primary);
    }

    /* Profile Player */
    .player-profile {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem;
      background: var(--player-bg);
      border: 1px solid var(--player-border);
      border-radius: var(--player-radius);
    }

    .player-profile__avatar {
      width: 3.5rem;
      height: 3.5rem;
      border-radius: 50%;
      background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
      flex-shrink: 0;
      display: flex;
      align-items: center;
      justify-content: center;
      color: white;
      font-weight: 600;
      font-size: 1.25rem;
    }

    .player-profile__avatar--rounded {
      border-radius: 0.5rem;
    }

    .player-profile__avatar--square {
      border-radius: 0;
    }

    .player-profile__info {
      flex: 1;
      min-width: 0;
    }

    .player-profile__name {
      font-size: 0.9375rem;
      font-weight: 600;
      color: var(--player-text);
      margin-bottom: 0.125rem;
    }

    .player-profile__role {
      font-size: 0.8125rem;
      color: var(--player-text-secondary);
    }

    .player-profile__play {
      width: 2.5rem;
      height: 2.5rem;
      border-radius: 50%;
      background: var(--player-primary);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      flex-shrink: 0;
    }

    .player-profile__play-icon {
      font-size: 0.875rem;
      color: white;
      margin-left: 2px;
    }

    /* Product Player */
    .player-product {
      display: flex;
      align-items: center;
      gap: 1rem;
      padding: 1rem 1.25rem;
      background: var(--player-bg);
      border: 1px solid var(--player-border);
      border-radius: var(--player-radius);
    }

    .player-product__play {
      width: 3rem;
      height: 3rem;
      border-radius: 50%;
      background: var(--player-primary);
      border: none;
      display: flex;
      align-items: center;
      justify-content: center;
      cursor: pointer;
      flex-shrink: 0;
    }

    .player-product__play-icon {
      font-size: 1rem;
      color: white;
      margin-left: 3px;
    }

    .player-product__info {
      flex: 1;
      min-width: 0;
    }

    .player-product__title {
      font-size: 1rem;
      font-weight: 600;
      color: var(--player-text);
      margin-bottom: 0.25rem;
    }

    .player-product__subtitle {
      font-size: 0.8125rem;
      color: var(--player-text-secondary);
    }

    .player-product__waveform {
      display: flex;
      align-items: center;
      gap: 3px;
      height: 2rem;
      width: 120px;
      flex-shrink: 0;
    }

    /* When product uses progress waveform, allow it to expand */
    .player-product__waveform.player-full__waveform--progress {
      flex: 1;
      min-width: 100px;
      width: auto;
    }

    /* When product uses SVG-based waveforms */
    .player-product__waveform.player-full__waveform--smooth svg,
    .player-product__waveform.player-full__waveform--line svg,
    .player-product__waveform.player-full__waveform--blob svg {
      width: 100%;
      height: 100%;
    }

    .player-product__wave-bar {
      flex: 1;
      background: var(--player-wave-inactive);
      border-radius: 2px;
    }

    .player-product__wave-bar.is-active {
      background: var(--player-wave-active);
    }

    .player-product__wave-dot {
      width: 4px;
      height: 4px;
      background: var(--player-wave-inactive);
      border-radius: 50%;
    }

    .player-product__wave-dot.is-active {
      background: var(--player-wave-active);
    }

    .player-product__timer {
      font-size: 0.8125rem;
      color: var(--player-text-secondary);
      flex-shrink: 0;
    }

    /* ============================================
       RESPONSIVE
       ============================================ */
    @media (max-width: 900px) {
      .builder__content {
        grid-template-columns: 1fr;
      }

      .preview {
        position: static;
      }
    }
  </style>
</head>
<body>
  <div class="builder">
    <!-- Header -->
    <header class="builder__header">
      <div class="builder__title">Builder</div>
      <button class="theme-toggle" id="theme-toggle">
        <i class="fa-solid fa-moon"></i>
        <i class="fa-solid fa-sun"></i>
      </button>
    </header>

    <!-- Main Content -->
    <div class="builder__content">
      <!-- Controls Panel -->
      <div class="controls">
        <!-- Step 1: Player Type -->
        <div class="controls__step" data-step="1">
          <div class="controls__step-header">
            <div class="controls__step-number">1</div>
            <div class="controls__step-title">Player Type</div>
            <i class="fa-solid fa-chevron-down controls__step-toggle"></i>
          </div>
          <div class="controls__step-content">
            <div class="player-tabs">
              <button class="player-tab is-active" data-player="full">Full</button>
              <button class="player-tab" data-player="mini">Mini</button>
              <button class="player-tab" data-player="pill">Pill</button>
            </div>
          </div>
        </div>

        <!-- Step 2: Player Options -->
        <div class="controls__step" data-step="2">
          <div class="controls__step-header">
            <div class="controls__step-number">2</div>
            <div class="controls__step-title">Player Options</div>
            <i class="fa-solid fa-chevron-down controls__step-toggle"></i>
          </div>
          <div class="controls__step-content">
            <!-- Full Player Options -->
            <div class="player-options is-active" data-options="full">
              <!-- Player Style -->
              <div class="options-group">
                <div class="options-group__title">Player</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Background</label>
                    <div class="color-input">
                      <input type="color" id="brand-bg" value="#FFFFFF">
                      <span class="color-value" id="brand-bg-value">#FFFFFF</span>
                    </div>
                    <label class="checkbox-label" style="margin-top: 0.5rem;">
                      <input type="checkbox" id="brand-bg-transparent">
                      <span>Transparent</span>
                    </label>
                  </div>
                  <div class="control-group">
                    <label>Border Color</label>
                    <div class="color-input">
                      <input type="color" id="brand-border" value="#E2E8F0">
                      <span class="color-value" id="brand-border-value">#E2E8F0</span>
                    </div>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Border Thickness</label>
                    <select class="select-input" id="brand-player-border-thickness">
                      <option value="0">None</option>
                      <option value="1px" selected>1px</option>
                      <option value="2px">2px</option>
                      <option value="3px">3px</option>
                    </select>
                  </div>
                  <div class="control-group">
                    <label>Shape</label>
                    <select class="select-input" id="brand-player-shape">
                      <option value="pill">Pill</option>
                      <option value="rounded" selected>Rounded</option>
                      <option value="square">Square</option>
                      <option value="custom">Custom</option>
                    </select>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group" id="brand-player-custom-radius-group" style="display: none;">
                    <label>Custom Radius</label>
                    <input type="range" class="range-input" id="brand-player-custom-radius" min="0" max="50" value="12">
                    <span class="range-value" id="brand-player-custom-radius-value">12px</span>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Padding</label>
                    <select class="select-input" id="brand-player-padding">
                      <option value="tight">Tight</option>
                      <option value="normal" selected>Normal</option>
                      <option value="spacious">Spacious</option>
                      <option value="custom">Custom</option>
                    </select>
                  </div>
                  <div class="control-group" id="brand-player-custom-padding-group" style="display: none;">
                    <label>Custom (rem)</label>
                    <input type="number" class="text-input" id="brand-player-custom-padding" value="1" min="0" max="4" step="0.25">
                  </div>
                </div>
              </div>

              <!-- Text Colors -->
              <div class="options-group">
                <div class="options-group__title">Text</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Text Color</label>
                    <div class="color-input">
                      <input type="color" id="brand-text" value="#0F172A">
                      <span class="color-value" id="brand-text-value">#0F172A</span>
                    </div>
                  </div>
                  <div class="control-group">
                    <label>Text Secondary</label>
                    <div class="color-input">
                      <input type="color" id="brand-text-secondary" value="#64748B">
                      <span class="color-value" id="brand-text-secondary-value">#64748B</span>
                    </div>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Label Color</label>
                    <div class="color-input">
                      <input type="color" id="brand-label-color" value="#64748B">
                      <span class="color-value" id="brand-label-color-value">#64748B</span>
                    </div>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Link Color</label>
                    <div class="color-input">
                      <input type="color" id="brand-link-color" value="#3B82F6">
                      <span class="color-value" id="brand-link-color-value">#3B82F6</span>
                    </div>
                  </div>
                  <div class="control-group">
                    <label>Link Hover</label>
                    <div class="color-input">
                      <input type="color" id="brand-link-hover" value="#2563EB">
                      <span class="color-value" id="brand-link-hover-value">#2563EB</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Button Colors -->
              <div class="options-group">
                <div class="options-group__title">Button</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Button Color</label>
                    <div class="color-input">
                      <input type="color" id="brand-button-color" value="#3B82F6">
                      <span class="color-value" id="brand-button-color-value">#3B82F6</span>
                    </div>
                    <label class="checkbox-label" style="margin-top: 0.5rem;">
                      <input type="checkbox" id="brand-button-transparent">
                      <span>Transparent</span>
                    </label>
                  </div>
                  <div class="control-group">
                    <label>Icon Color</label>
                    <div class="color-input">
                      <input type="color" id="brand-icon-color" value="#FFFFFF">
                      <span class="color-value" id="brand-icon-color-value">#FFFFFF</span>
                    </div>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Border Color</label>
                    <div class="color-input">
                      <input type="color" id="brand-button-border-color" value="#3B82F6">
                      <span class="color-value" id="brand-button-border-color-value">#3B82F6</span>
                    </div>
                  </div>
                  <div class="control-group">
                    <label>Border Thickness</label>
                    <select class="select-input" id="brand-button-border-thickness">
                      <option value="0" selected>None</option>
                      <option value="1px">1px</option>
                      <option value="2px">2px</option>
                      <option value="3px">3px</option>
                    </select>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Button Shape</label>
                    <select class="select-input" id="brand-button-shape">
                      <option value="pill" selected>Pill</option>
                      <option value="rounded">Rounded</option>
                      <option value="square">Square</option>
                      <option value="custom">Custom</option>
                    </select>
                  </div>
                  <div class="control-group" id="brand-button-custom-radius-group" style="display: none;">
                    <label>Custom Radius</label>
                    <input type="range" class="range-input" id="brand-button-custom-radius" min="0" max="50" value="8">
                    <span class="range-value" id="brand-button-custom-radius-value">8px</span>
                  </div>
                </div>
              </div>

              <!-- Waveform & Timer -->
              <div class="options-group">
                <div class="options-group__title">Waveform & Timer</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Show Waveform</label>
                    <select class="select-input" id="brand-show-waveform">
                      <option value="yes" selected>Yes</option>
                      <option value="no">No</option>
                    </select>
                  </div>
                  <div class="control-group">
                    <label>Show Timer</label>
                    <select class="select-input" id="brand-show-timer">
                      <option value="yes" selected>Yes</option>
                      <option value="no">No</option>
                    </select>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Time Format</label>
                    <select class="select-input" id="brand-time-format">
                      <option value="elapsed-total" selected>0:00 / 1:00</option>
                      <option value="elapsed">0:00</option>
                      <option value="remaining">-1:00</option>
                      <option value="seconds">0s</option>
                      <option value="mm-ss">00:00</option>
                      <option value="total-only">1:00</option>
                    </select>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Type</label>
                    <select class="select-input" id="brand-waveform-type">
                      <option value="bars" selected>Bars</option>
                      <option value="smooth">Smooth</option>
                      <option value="dots">Dots</option>
                      <option value="line">Line</option>
                      <option value="blob">Blob</option>
                      <option value="progress">Progress</option>
                    </select>
                  </div>
                  <div class="control-group">
                    <label>Thickness</label>
                    <select class="select-input" id="brand-waveform-thickness">
                      <option value="thin">Thin (2px)</option>
                      <option value="normal" selected>Normal (4px)</option>
                      <option value="thick">Thick (6px)</option>
                    </select>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Active Color</label>
                    <div class="color-input">
                      <input type="color" id="brand-wave-active" value="#3B82F6">
                      <span class="color-value" id="brand-wave-active-value">#3B82F6</span>
                    </div>
                  </div>
                  <div class="control-group">
                    <label>Inactive Color</label>
                    <div class="color-input">
                      <input type="color" id="brand-wave-inactive" value="#CBD5E1">
                      <span class="color-value" id="brand-wave-inactive-value">#CBD5E1</span>
                    </div>
                  </div>
                </div>
              </div>

              <!-- Transcript & Translation -->
              <div class="options-group">
                <div class="options-group__title">Transcript & Translation</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Show Transcript</label>
                    <select class="select-input" id="full-show-transcript">
                      <option value="no" selected>No</option>
                      <option value="yes">Yes</option>
                    </select>
                  </div>
                  <div class="control-group">
                    <label>Show Translation</label>
                    <select class="select-input" id="full-show-translation">
                      <option value="no" selected>No</option>
                      <option value="yes">Yes</option>
                    </select>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Background</label>
                    <div class="color-input">
                      <input type="color" id="full-transcript-bg" value="#F1F5F9">
                      <span class="color-value" id="full-transcript-bg-value">#F1F5F9</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Mini Player Options -->
            <div class="player-options" data-options="mini">
              <!-- Size & Position -->
              <div class="options-group">
                <div class="options-group__title">Size & Position</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Size</label>
                    <select class="select-input" id="mini-size">
                      <option value="sm">Small (40px)</option>
                      <option value="md" selected>Medium (56px)</option>
                      <option value="lg">Large (72px)</option>
                    </select>
                  </div>
                  <div class="control-group">
                    <label>Position</label>
                    <select class="select-input" id="mini-position">
                      <option value="center" selected>Center</option>
                      <option value="bottom-left">Bottom Left</option>
                      <option value="bottom-center">Bottom Center</option>
                      <option value="bottom-right">Bottom Right</option>
                    </select>
                  </div>
                </div>
              </div>
              <!-- Animation -->
              <div class="options-group">
                <div class="options-group__title">Animation</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Animation</label>
                    <select class="select-input" id="mini-animation">
                      <option value="none">None</option>
                      <option value="circular" selected>Circular Progress</option>
                      <option value="pulse">Pulse</option>
                      <option value="rings">Pulse Rings</option>
                    </select>
                  </div>
                </div>
              </div>
              <!-- Button Style -->
              <div class="options-group">
                <div class="options-group__title">Button</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Button Color</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-button-color" value="#3B82F6">
                      <span class="color-value">#3B82F6</span>
                    </div>
                    <label class="checkbox-label" style="margin-top: 0.5rem;">
                      <input type="checkbox" class="shared-brand-button-transparent">
                      <span>Transparent</span>
                    </label>
                  </div>
                  <div class="control-group">
                    <label>Icon Color</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-icon-color" value="#FFFFFF">
                      <span class="color-value">#FFFFFF</span>
                    </div>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Border Color</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-button-border-color" value="#3B82F6">
                      <span class="color-value">#3B82F6</span>
                    </div>
                  </div>
                  <div class="control-group">
                    <label>Border Thickness</label>
                    <select class="select-input shared-brand-button-border-thickness">
                      <option value="0" selected>None</option>
                      <option value="1px">1px</option>
                      <option value="2px">2px</option>
                      <option value="3px">3px</option>
                    </select>
                  </div>
                </div>
              </div>
            </div>

            <!-- Pill Player Options -->
            <div class="player-options" data-options="pill">
              <!-- Size -->
              <div class="options-group">
                <div class="options-group__title">Size</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Height</label>
                    <select class="select-input" id="pill-size">
                      <option value="xs">Extra Small (28px)</option>
                      <option value="sm">Small (36px)</option>
                      <option value="md" selected>Medium (44px)</option>
                      <option value="lg">Large (56px)</option>
                      <option value="custom">Custom</option>
                    </select>
                  </div>
                  <div class="control-group" id="pill-custom-size-group" style="display: none;">
                    <label>Height (px)</label>
                    <input type="range" class="range-input" id="pill-custom-size" min="24" max="72" value="44">
                    <span class="range-value" id="pill-custom-size-value">44px</span>
                  </div>
                </div>
              </div>
              <!-- Player Style -->
              <div class="options-group">
                <div class="options-group__title">Player</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Background</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-bg" value="#FFFFFF">
                      <span class="color-value">#FFFFFF</span>
                    </div>
                    <label class="checkbox-label" style="margin-top: 0.5rem;">
                      <input type="checkbox" class="shared-brand-bg-transparent">
                      <span>Transparent</span>
                    </label>
                  </div>
                  <div class="control-group">
                    <label>Border Color</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-border" value="#E2E8F0">
                      <span class="color-value">#E2E8F0</span>
                    </div>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Border Thickness</label>
                    <select class="select-input shared-brand-player-border-thickness">
                      <option value="0">None</option>
                      <option value="1px" selected>1px</option>
                      <option value="2px">2px</option>
                      <option value="3px">3px</option>
                    </select>
                  </div>
                  <div class="control-group">
                    <label>Shape</label>
                    <select class="select-input shared-brand-player-shape">
                      <option value="pill">Pill</option>
                      <option value="rounded" selected>Rounded</option>
                      <option value="square">Square</option>
                    </select>
                  </div>
                </div>
              </div>
              <!-- Text Colors -->
              <div class="options-group">
                <div class="options-group__title">Text</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Text Color</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-text" value="#0F172A">
                      <span class="color-value">#0F172A</span>
                    </div>
                  </div>
                  <div class="control-group">
                    <label>Text Secondary</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-text-secondary" value="#64748B">
                      <span class="color-value">#64748B</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Button Style -->
              <div class="options-group">
                <div class="options-group__title">Button</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Button Color</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-button-color" value="#3B82F6">
                      <span class="color-value">#3B82F6</span>
                    </div>
                    <label class="checkbox-label" style="margin-top: 0.5rem;">
                      <input type="checkbox" class="shared-brand-button-transparent">
                      <span>Transparent</span>
                    </label>
                  </div>
                  <div class="control-group">
                    <label>Icon Color</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-icon-color" value="#FFFFFF">
                      <span class="color-value">#FFFFFF</span>
                    </div>
                  </div>
                </div>
              </div>
              <!-- Waveform -->
              <div class="options-group">
                <div class="options-group__title">Waveform</div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Type</label>
                    <select class="select-input shared-brand-waveform-type">
                      <option value="bars" selected>Bars</option>
                      <option value="smooth">Smooth</option>
                      <option value="dots">Dots</option>
                      <option value="line">Line</option>
                      <option value="blob">Blob</option>
                      <option value="progress">Progress</option>
                    </select>
                  </div>
                  <div class="control-group">
                    <label>Thickness</label>
                    <select class="select-input shared-brand-waveform-thickness">
                      <option value="thin">Thin (2px)</option>
                      <option value="normal" selected>Normal (4px)</option>
                      <option value="thick">Thick (6px)</option>
                    </select>
                  </div>
                </div>
                <div class="control-row">
                  <div class="control-group">
                    <label>Active Color</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-wave-active" value="#3B82F6">
                      <span class="color-value">#3B82F6</span>
                    </div>
                  </div>
                  <div class="control-group">
                    <label>Inactive Color</label>
                    <div class="color-input">
                      <input type="color" class="shared-brand-wave-inactive" value="#CBD5E1">
                      <span class="color-value">#CBD5E1</span>
                    </div>
                  </div>
                </div>
              </div>
            </div>

          </div>
        </div>
      </div>

      <!-- Preview Panel -->
      <div class="preview">
        <div class="preview__header">
          <span class="preview__title">Live Preview</span>
        </div>

        <!-- Full Player Responsive Preview (with ruler) -->
        <div class="responsive-preview" id="responsive-preview">
          <!-- Breakpoint Ruler -->
          <div class="responsive-preview__ruler" id="responsive-ruler">
            <div class="responsive-preview__indicator" id="responsive-indicator"></div>
            <div class="responsive-preview__breakpoint" data-bp="mobile" data-width="320">
              <span class="responsive-preview__bp-label">Mobile</span>
            </div>
            <div class="responsive-preview__breakpoint" data-bp="sm" data-width="480">
              <span class="responsive-preview__bp-label">sm</span>
            </div>
            <div class="responsive-preview__breakpoint" data-bp="md" data-width="768">
              <span class="responsive-preview__bp-label">md</span>
            </div>
            <div class="responsive-preview__breakpoint" data-bp="lg" data-width="1024">
              <span class="responsive-preview__bp-label">lg</span>
            </div>
            <div class="responsive-preview__breakpoint" data-bp="xl" data-width="1200">
              <span class="responsive-preview__bp-label">xl</span>
            </div>
          </div>

          <!-- Outer wrapper with handle -->
          <div class="responsive-preview__wrapper">
            <div class="responsive-preview__container" id="responsive-container">
              <div class="responsive-preview__content" id="responsive-content">
                <div class="player-full" id="preview-full">
                  <div class="player-full__main">
                    <div class="player-full__controls">
                      <button class="player-full__play">
                        <i class="fa-solid fa-play player-full__play-icon player-full__play-icon--play"></i>
                        <i class="fa-solid fa-pause player-full__play-icon player-full__play-icon--pause"></i>
                      </button>
                      <div class="player-full__waveform player-full__waveform--bars" id="full-waveform-container">
                        <!-- Waveform bars generated by JS -->
                      </div>
                      <div class="player-full__timer" id="full-timer">
                        <span class="player-full__timer-current">0:00</span>
                        <span>/</span>
                        <span>1:00</span>
                      </div>
                    </div>
                  </div>
                  <!-- Transcript Section -->
                  <div class="player-full__transcript-section" id="transcript-section" style="display: none;">
                    <div class="player-full__transcript-label">Transcript</div>
                    <div class="player-full__transcript-text">Welcome to our product demo. Today we'll walk through the key features that make our platform unique. Our solution helps teams collaborate more effectively by streamlining workflows and reducing manual tasks. We've designed every feature with simplicity in mind, so you can focus on what matters most - getting work done.</div>
                    <a class="player-full__transcript-more" data-collapsed="Show more" data-expanded="Show less">Show more</a>
                  </div>
                  <!-- Translation Section -->
                  <div class="player-full__transcript-section" id="translation-section" style="display: none;">
                    <div class="player-full__transcript-label">Translation (ES)</div>
                    <div class="player-full__transcript-text">Bienvenido a nuestra demostracin de producto. Hoy le mostraremos las caractersticas clave que hacen nica nuestra plataforma. Nuestra solucin ayuda a los equipos a colaborar de manera ms efectiva al optimizar los flujos de trabajo y reducir las tareas manuales. Hemos diseado cada funcin pensando en la simplicidad.</div>
                    <a class="player-full__transcript-more" data-collapsed="Mostrar ms" data-expanded="Mostrar menos">Mostrar ms</a>
                  </div>
                </div>
              </div>
            </div>
            <div class="responsive-preview__handle" id="responsive-handle">
              <div class="responsive-preview__handle-bar"></div>
            </div>
          </div>

          <!-- Width display -->
          <div class="responsive-preview__width">
            <span id="responsive-width-value">1200px / 75.00rem</span>
          </div>
        </div>

        <!-- Non-Full Player Preview -->
        <div class="preview__container" id="preview-container" style="display: none;">
          <div class="preview__player" id="preview-player">
            <!-- Mini Player Preview -->
            <div class="preview__mini-wrapper" id="preview-mini" style="display: none;">
              <div class="player-mini player-mini--md player-mini--center" id="mini-player" onclick="toggleMiniPlayer(event, this)">
                <!-- Progress Ring - track and fill as real elements -->
                <div class="player-mini__progress-ring">
                  <div class="player-mini__progress-track"></div>
                  <div class="player-mini__progress-fill"></div>
                </div>
                <svg class="player-mini__icon player-mini__icon--play" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M8 5v14l11-7z"/>
                </svg>
                <svg class="player-mini__icon player-mini__icon--pause" viewBox="0 0 24 24" fill="currentColor">
                  <path d="M6 19h4V5H6v14zm8-14v14h4V5h-4z"/>
                </svg>
              </div>
            </div>

            <!-- Pill Player Preview -->
            <div class="player-pill" id="preview-pill" style="display: none;">
              <button class="player-pill__play">
                <i class="fa-solid fa-play player-pill__play-icon"></i>
              </button>
              <div class="player-pill__waveform" id="pill-waveform-container">
                <!-- Waveform bars generated by JS -->
              </div>
              <span class="player-pill__timer">0:00 / 1:00</span>
            </div>

          </div>
        </div>

        <!-- Examples Section -->
        <div class="examples-section" id="examples-section">
          <div class="examples-section__header">
            <span class="examples-section__title">Use Case Examples</span>
          </div>

          <!-- Full Player Examples -->
          <div class="examples-grid" id="examples-full">
            <!-- Article Embed -->
            <div class="example-card">
              <div class="example-card__label">Article Embed</div>
              <div class="example-card__preview">
                <div class="example-article">
                  <p class="example-article__text">The future of voice technology is transforming how we interact with digital content. From podcasts to audiobooks, audio is becoming the preferred medium for consuming information on the go.</p>
                  <div class="example-player-wrapper">
                    <div class="player-full example-player example-player--full">
                      <div class="player-full__main">
                        <button class="player-full__play">
                          <i class="fa-solid fa-play player-full__play-icon"></i>
                        </button>
                        <div class="player-full__waveform player-full__waveform--bars example-waveform"></div>
                        <span class="player-full__timer">0:00 / 2:34</span>
                      </div>
                    </div>
                  </div>
                  <p class="example-article__text">Research shows that audio content increases retention by up to 40% compared to text alone, making it an essential tool for modern communication.</p>
                </div>
              </div>
            </div>

            <!-- Podcast Episode -->
            <div class="example-card">
              <div class="example-card__label">Podcast Episode</div>
              <div class="example-card__preview">
                <div class="example-podcast">
                  <img src="https://images.unsplash.com/photo-1478737270239-2f02b77fc618?w=200&h=200&fit=crop" alt="Podcast Art" class="example-podcast__art">
                  <div class="example-podcast__info">
                    <h4 class="example-podcast__title">The Creative Process</h4>
                    <p class="example-podcast__meta">Episode 47  45 min</p>
                  </div>
                  <div class="example-player-wrapper">
                    <div class="player-full example-player example-player--full">
                      <div class="player-full__main">
                        <button class="player-full__play">
                          <i class="fa-solid fa-play player-full__play-icon"></i>
                        </button>
                        <div class="player-full__waveform player-full__waveform--bars example-waveform"></div>
                        <span class="player-full__timer">0:00 / 45:00</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Course Lesson -->
            <div class="example-card">
              <div class="example-card__label">Course Lesson</div>
              <div class="example-card__preview">
                <div class="example-course">
                  <div class="example-course__header">
                    <span class="example-course__lesson">Lesson 3 of 12</span>
                    <h4 class="example-course__title">Introduction to Design Systems</h4>
                  </div>
                  <div class="example-player-wrapper">
                    <div class="player-full example-player example-player--full">
                      <div class="player-full__main">
                        <button class="player-full__play">
                          <i class="fa-solid fa-play player-full__play-icon"></i>
                        </button>
                        <div class="player-full__waveform player-full__waveform--bars example-waveform"></div>
                        <span class="player-full__timer">0:00 / 8:22</span>
                      </div>
                    </div>
                  </div>
                  <div class="example-course__nav">
                    <button class="example-course__btn"><i class="fa-solid fa-chevron-left"></i> Previous</button>
                    <button class="example-course__btn example-course__btn--primary">Next <i class="fa-solid fa-chevron-right"></i></button>
                  </div>
                </div>
              </div>
            </div>

            <!-- Landing Page -->
            <div class="example-card">
              <div class="example-card__label">Landing Page</div>
              <div class="example-card__preview">
                <div class="example-landing">
                  <div class="example-landing__hero">
                    <h3 class="example-landing__title">Hear Our Story</h3>
                    <p class="example-landing__subtitle">A 2-minute intro from our founder</p>
                  </div>
                  <div class="example-player-wrapper">
                    <div class="player-full example-player example-player--full">
                      <div class="player-full__main">
                        <button class="player-full__play">
                          <i class="fa-solid fa-play player-full__play-icon"></i>
                        </button>
                        <div class="player-full__waveform player-full__waveform--bars example-waveform"></div>
                        <span class="player-full__timer">0:00 / 2:15</span>
                      </div>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Mini Player Examples -->
          <div class="examples-grid" id="examples-mini" style="display: none;">
            <!-- Artwork Overlay -->
            <div class="example-card">
              <div class="example-card__label">Artwork Overlay</div>
              <div class="example-card__preview example-card__preview--dark">
                <div class="example-artwork">
                  <img src="https://images.unsplash.com/photo-1541961017774-22349e4a1262?w=400&h=300&fit=crop" alt="Artwork" class="example-artwork__image">
                  <div class="example-artwork__overlay">
                    <div class="example-artwork__info">
                      <h4 class="example-artwork__title">Starry Night</h4>
                      <p class="example-artwork__artist">Vincent van Gogh, 1889</p>
                    </div>
                    <div class="player-mini example-mini-player" id="example-mini-1">
                      <div class="player-mini__progress-ring">
                        <div class="player-mini__progress-track"></div>
                        <div class="player-mini__progress-fill"></div>
                      </div>
                      <svg class="player-mini__icon player-mini__icon--play" viewBox="0 0 24 24" fill="currentColor">
                        <path d="M8 5v14l11-7z"/>
                      </svg>
                    </div>
                  </div>
                </div>
              </div>
            </div>

            <!-- Product Card -->
            <div class="example-card">
              <div class="example-card__label">Product Card</div>
              <div class="example-card__preview">
                <div class="example-product">
                  <img src="https://images.unsplash.com/photo-1505740420928-5e560c06d30e?w=200&h=200&fit=crop" alt="Headphones" class="example-product__image">
                  <div class="example-product__info">
                    <h4 class="example-product__name">Pro Headphones X1</h4>
                    <p class="example-product__price">$299.00</p>
                    <p class="example-product__desc">Premium wireless headphones with noise cancellation</p>
                  </div>
                  <div class="player-mini example-mini-player example-mini-player--sm" id="example-mini-2">
                    <div class="player-mini__progress-ring">
                      <div class="player-mini__progress-track"></div>
                      <div class="player-mini__progress-fill"></div>
                    </div>
                    <svg class="player-mini__icon player-mini__icon--play" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                  </div>
                </div>
              </div>
            </div>

            <!-- Profile Card -->
            <div class="example-card">
              <div class="example-card__label">Profile Card</div>
              <div class="example-card__preview">
                <div class="example-profile">
                  <img src="https://images.unsplash.com/photo-1494790108377-be9c29b29330?w=200&h=200&fit=crop" alt="Profile" class="example-profile__avatar">
                  <div class="example-profile__info">
                    <h4 class="example-profile__name">Sarah Chen</h4>
                    <p class="example-profile__role">Product Designer at Figma</p>
                  </div>
                  <div class="player-mini example-mini-player" id="example-mini-3">
                    <div class="player-mini__progress-ring">
                      <div class="player-mini__progress-track"></div>
                      <div class="player-mini__progress-fill"></div>
                    </div>
                    <svg class="player-mini__icon player-mini__icon--play" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                  </div>
                </div>
              </div>
            </div>

            <!-- Audio Guide -->
            <div class="example-card">
              <div class="example-card__label">Audio Guide</div>
              <div class="example-card__preview example-card__preview--dark">
                <div class="example-guide">
                  <img src="https://images.unsplash.com/photo-1499781350541-7783f6c6a0c8?w=400&h=250&fit=crop" alt="Museum" class="example-guide__image">
                  <div class="example-guide__content">
                    <span class="example-guide__number">Stop 7</span>
                    <h4 class="example-guide__title">The Grand Gallery</h4>
                  </div>
                  <div class="player-mini example-mini-player example-mini-player--float" id="example-mini-4">
                    <div class="player-mini__progress-ring">
                      <div class="player-mini__progress-track"></div>
                      <div class="player-mini__progress-fill"></div>
                    </div>
                    <svg class="player-mini__icon player-mini__icon--play" viewBox="0 0 24 24" fill="currentColor">
                      <path d="M8 5v14l11-7z"/>
                    </svg>
                  </div>
                </div>
              </div>
            </div>
          </div>

          <!-- Pill Player Examples -->
          <div class="examples-grid" id="examples-pill" style="display: none;">
            <!-- Chat Message -->
            <div class="example-card">
              <div class="example-card__label">Chat Message</div>
              <div class="example-card__preview">
                <div class="example-chat">
                  <div class="example-chat__message example-chat__message--them">
                    <p>Hey! Can you send me that voice note about the project?</p>
                  </div>
                  <div class="example-chat__message example-chat__message--me">
                    <div class="player-pill example-player example-player--pill">
                      <button class="player-pill__play">
                        <i class="fa-solid fa-play player-pill__play-icon"></i>
                      </button>
                      <div class="player-pill__waveform player-full__waveform--bars example-waveform-pill"></div>
                      <span class="player-pill__timer">0:42</span>
                    </div>
                  </div>
                  <div class="example-chat__message example-chat__message--them">
                    <p>Perfect, thanks! </p>
                  </div>
                </div>
              </div>
            </div>

            <!-- Social Bio -->
            <div class="example-card">
              <div class="example-card__label">Social Bio</div>
              <div class="example-card__preview">
                <div class="example-bio">
                  <img src="https://images.unsplash.com/photo-1507003211169-0a1dd7228f2d?w=200&h=200&fit=crop" alt="Profile" class="example-bio__avatar">
                  <h4 class="example-bio__name">Alex Rivera</h4>
                  <p class="example-bio__handle">@alexrivera  Creator</p>
                  <p class="example-bio__desc">Building tools for creators. Previously @Spotify</p>
                  <div class="player-pill example-player example-player--pill example-bio__player">
                    <button class="player-pill__play">
                      <i class="fa-solid fa-play player-pill__play-icon"></i>
                    </button>
                    <div class="player-pill__waveform player-full__waveform--bars example-waveform-pill"></div>
                    <span class="player-pill__timer">0:30</span>
                  </div>
                </div>
              </div>
            </div>

            <!-- Voice Note -->
            <div class="example-card">
              <div class="example-card__label">Voice Note</div>
              <div class="example-card__preview">
                <div class="example-note">
                  <div class="example-note__header">
                    <div>
                      <h4 class="example-note__title">Meeting Notes</h4>
                      <p class="example-note__date">Dec 15, 2024  2:30 PM</p>
                    </div>
                    <i class="fa-solid fa-ellipsis example-note__menu"></i>
                  </div>
                  <div class="player-pill example-player example-player--pill">
                    <button class="player-pill__play">
                      <i class="fa-solid fa-play player-pill__play-icon"></i>
                    </button>
                    <div class="player-pill__waveform player-full__waveform--bars example-waveform-pill"></div>
                    <span class="player-pill__timer">1:24</span>
                  </div>
                  <p class="example-note__text">Quick recap of the design review session. Key points: new color system approved, need to finalize icons by Friday...</p>
                </div>
              </div>
            </div>

            <!-- Testimonial -->
            <div class="example-card">
              <div class="example-card__label">Testimonial</div>
              <div class="example-card__preview">
                <div class="example-testimonial">
                  <p class="example-testimonial__quote">"This tool completely changed how we communicate with our customers. The voice messages feel so much more personal."</p>
                  <div class="player-pill example-player example-player--pill">
                    <button class="player-pill__play">
                      <i class="fa-solid fa-play player-pill__play-icon"></i>
                    </button>
                    <div class="player-pill__waveform player-full__waveform--bars example-waveform-pill"></div>
                    <span class="player-pill__timer">0:18</span>
                  </div>
                  <div class="example-testimonial__author">
                    <img src="https://images.unsplash.com/photo-1472099645785-5658abf4ff4e?w=100&h=100&fit=crop" alt="Author" class="example-testimonial__avatar">
                    <div>
                      <h5 class="example-testimonial__name">Michael Torres</h5>
                      <p class="example-testimonial__role">CEO at TechFlow</p>
                    </div>
                  </div>
                </div>
              </div>
            </div>
          </div>
        </div>
      </div>
    </div>
  </div>

  <script>
    // ============================================
    // BUILDER JAVASCRIPT
    // ============================================

    // Theme Toggle
    const themeToggle = document.getElementById('theme-toggle');
    themeToggle.addEventListener('click', () => {
      const html = document.documentElement;
      const current = html.getAttribute('data-theme');
      html.setAttribute('data-theme', current === 'dark' ? 'light' : 'dark');
    });

    // Step Collapse/Expand
    document.querySelectorAll('.controls__step-header').forEach(header => {
      header.addEventListener('click', () => {
        header.parentElement.classList.toggle('is-collapsed');
      });
    });

    // Player Type Tabs
    const playerTabs = document.querySelectorAll('.player-tab');
    const playerOptions = document.querySelectorAll('.player-options');
    const previewPlayers = {
      full: document.getElementById('preview-full'),
      mini: document.getElementById('preview-mini'),
      pill: document.getElementById('preview-pill')
    };

    const responsivePreviewEl = document.getElementById('responsive-preview');
    const previewContainerEl = document.getElementById('preview-container');

    // Examples grids
    const examplesGrids = {
      full: document.getElementById('examples-full'),
      mini: document.getElementById('examples-mini'),
      pill: document.getElementById('examples-pill')
    };

    playerTabs.forEach(tab => {
      tab.addEventListener('click', () => {
        const playerType = tab.dataset.player;

        // Update active tab
        playerTabs.forEach(t => t.classList.remove('is-active'));
        tab.classList.add('is-active');

        // Update options panel
        playerOptions.forEach(opt => {
          opt.classList.toggle('is-active', opt.dataset.options === playerType);
        });

        // Show/hide responsive preview (only for Full player)
        if (playerType === 'full') {
          responsivePreviewEl.style.display = '';
          previewContainerEl.style.display = 'none';
          // Regenerate waveform bars
          setTimeout(regenerateWaveformBars, 10);
        } else {
          responsivePreviewEl.style.display = 'none';
          previewContainerEl.style.display = '';
        }

        // Update preview (for non-full players in the wrapper)
        ['mini', 'pill'].forEach(type => {
          if (previewPlayers[type]) {
            previewPlayers[type].style.display = type === playerType ? '' : 'none';
          }
        });

        // Update examples grid
        ['full', 'mini', 'pill'].forEach(type => {
          if (examplesGrids[type]) {
            examplesGrids[type].style.display = type === playerType ? '' : 'none';
          }
        });
      });
    });

    // Generate Waveform Bars - all start inactive
    function generateWaveform(container, count, maxHeight, thickness = 4) {
      container.innerHTML = '';
      for (let i = 0; i < count; i++) {
        const bar = document.createElement('div');
        const height = Math.random() * maxHeight + 4;
        bar.className = container.className.includes('pill') ? 'player-pill__wave-bar' : 'player-full__wave-bar';
        // Don't add is-active - bars start inactive
        bar.style.height = height + 'px';
        bar.style.width = thickness + 'px';
        container.appendChild(bar);
      }
    }

    // Initialize waveforms (pill uses fixed count, full player uses dynamic)
    generateWaveform(document.getElementById('pill-waveform-container'), 20, 20);

    // ============================================
    // STYLE CONTROLS
    // ============================================

    const brandControls = {
      bg: document.getElementById('brand-bg'),
      bgTransparent: document.getElementById('brand-bg-transparent'),
      border: document.getElementById('brand-border'),
      text: document.getElementById('brand-text'),
      textSecondary: document.getElementById('brand-text-secondary'),
      labelColor: document.getElementById('brand-label-color'),
      linkColor: document.getElementById('brand-link-color'),
      linkHover: document.getElementById('brand-link-hover'),
      buttonColor: document.getElementById('brand-button-color'),
      buttonTransparent: document.getElementById('brand-button-transparent'),
      iconColor: document.getElementById('brand-icon-color'),
      buttonBorderColor: document.getElementById('brand-button-border-color'),
      buttonBorderThickness: document.getElementById('brand-button-border-thickness'),
      buttonShape: document.getElementById('brand-button-shape'),
      buttonCustomRadius: document.getElementById('brand-button-custom-radius'),
      buttonCustomRadiusGroup: document.getElementById('brand-button-custom-radius-group'),
      showWaveform: document.getElementById('brand-show-waveform'),
      showTimer: document.getElementById('brand-show-timer'),
      timeFormat: document.getElementById('brand-time-format'),
      waveformType: document.getElementById('brand-waveform-type'),
      waveformThickness: document.getElementById('brand-waveform-thickness'),
      waveActive: document.getElementById('brand-wave-active'),
      waveInactive: document.getElementById('brand-wave-inactive'),
      playerShape: document.getElementById('brand-player-shape'),
      playerCustomRadius: document.getElementById('brand-player-custom-radius'),
      playerCustomRadiusGroup: document.getElementById('brand-player-custom-radius-group'),
      playerPadding: document.getElementById('brand-player-padding'),
      playerCustomPadding: document.getElementById('brand-player-custom-padding'),
      playerCustomPaddingGroup: document.getElementById('brand-player-custom-padding-group'),
      playerBorderThickness: document.getElementById('brand-player-border-thickness')
    };

    function updateBrandTheme() {
      const root = document.documentElement;

      // Show/hide button custom radius group
      brandControls.buttonCustomRadiusGroup.style.display =
        brandControls.buttonShape.value === 'custom' ? '' : 'none';

      // Show/hide player custom radius group
      brandControls.playerCustomRadiusGroup.style.display =
        brandControls.playerShape.value === 'custom' ? '' : 'none';

      // Show/hide player custom padding group
      brandControls.playerCustomPaddingGroup.style.display =
        brandControls.playerPadding.value === 'custom' ? '' : 'none';

      // Calculate button radius based on shape
      let buttonRadius;
      switch (brandControls.buttonShape.value) {
        case 'pill': buttonRadius = '9999px'; break;
        case 'rounded': buttonRadius = '0.5rem'; break;
        case 'square': buttonRadius = '0'; break;
        case 'custom': buttonRadius = brandControls.buttonCustomRadius.value + 'px'; break;
        default: buttonRadius = '9999px';
      }

      // Calculate player radius based on shape
      let playerRadius;
      switch (brandControls.playerShape.value) {
        case 'pill': playerRadius = '9999px'; break;
        case 'rounded': playerRadius = '0.75rem'; break;
        case 'square': playerRadius = '0'; break;
        case 'custom': playerRadius = brandControls.playerCustomRadius.value + 'px'; break;
        default: playerRadius = '0.75rem';
      }

      // Update CSS variables
      const bgValue = brandControls.bgTransparent.checked ? 'transparent' : brandControls.bg.value;
      root.style.setProperty('--player-bg', bgValue);
      root.style.setProperty('--player-border', brandControls.border.value);
      root.style.setProperty('--player-text', brandControls.text.value);
      root.style.setProperty('--player-text-secondary', brandControls.textSecondary.value);
      root.style.setProperty('--player-label-color', brandControls.labelColor.value);
      root.style.setProperty('--player-link-color', brandControls.linkColor.value);
      root.style.setProperty('--player-link-hover', brandControls.linkHover.value);
      root.style.setProperty('--player-button-color', brandControls.buttonColor.value);
      root.style.setProperty('--player-icon-color', brandControls.iconColor.value);
      root.style.setProperty('--player-button-border-color', brandControls.buttonBorderColor.value);
      root.style.setProperty('--player-button-border-thickness', brandControls.buttonBorderThickness.value);
      root.style.setProperty('--player-button-radius', buttonRadius);
      root.style.setProperty('--player-wave-active', brandControls.waveActive.value);
      root.style.setProperty('--player-wave-inactive', brandControls.waveInactive.value);
      root.style.setProperty('--player-radius', playerRadius);
      // Keep primary for backwards compat (uses button color)
      root.style.setProperty('--player-primary', brandControls.buttonColor.value);
      root.style.setProperty('--player-primary-hover', adjustColor(brandControls.buttonColor.value, -15));

      // Update color value displays
      document.getElementById('brand-bg-value').textContent = brandControls.bgTransparent.checked ? 'TRANSPARENT' : brandControls.bg.value.toUpperCase();
      document.getElementById('brand-border-value').textContent = brandControls.border.value.toUpperCase();
      document.getElementById('brand-text-value').textContent = brandControls.text.value.toUpperCase();
      document.getElementById('brand-text-secondary-value').textContent = brandControls.textSecondary.value.toUpperCase();
      document.getElementById('brand-label-color-value').textContent = brandControls.labelColor.value.toUpperCase();
      document.getElementById('brand-link-color-value').textContent = brandControls.linkColor.value.toUpperCase();
      document.getElementById('brand-link-hover-value').textContent = brandControls.linkHover.value.toUpperCase();
      document.getElementById('brand-button-color-value').textContent = brandControls.buttonTransparent.checked ? 'TRANSPARENT' : brandControls.buttonColor.value.toUpperCase();
      document.getElementById('brand-icon-color-value').textContent = brandControls.iconColor.value.toUpperCase();
      document.getElementById('brand-button-border-color-value').textContent = brandControls.buttonBorderColor.value.toUpperCase();
      document.getElementById('brand-button-custom-radius-value').textContent = brandControls.buttonCustomRadius.value + 'px';
      document.getElementById('brand-player-custom-radius-value').textContent = brandControls.playerCustomRadius.value + 'px';
      document.getElementById('brand-wave-active-value').textContent = brandControls.waveActive.value.toUpperCase();
      document.getElementById('brand-wave-inactive-value').textContent = brandControls.waveInactive.value.toUpperCase();

      // Apply button/icon colors to all players
      applyButtonColors();

      // Apply player shape to all player containers
      applyPlayerShape();

      // Apply player padding to all player containers
      applyPlayerPadding();

      // Apply player border to all player containers
      applyPlayerBorder();

      // Apply waveform settings to all players
      applyWaveformSettings();

      // Apply visibility settings (show/hide waveform, timer)
      applyVisibilitySettings();
    }

    // Apply button and icon colors to all players
    function applyButtonColors() {
      const buttonColor = brandControls.buttonTransparent.checked ? 'transparent' : brandControls.buttonColor.value;
      const iconColor = brandControls.iconColor.value;
      const buttonBorderColor = brandControls.buttonBorderColor.value;
      const buttonBorderThickness = brandControls.buttonBorderThickness.value;
      const labelColor = brandControls.labelColor.value;
      const linkColor = brandControls.linkColor.value;
      const linkHover = brandControls.linkHover.value;

      // Calculate button radius
      let buttonRadius;
      switch (brandControls.buttonShape.value) {
        case 'pill': buttonRadius = '9999px'; break;
        case 'rounded': buttonRadius = '0.5rem'; break;
        case 'square': buttonRadius = '0'; break;
        case 'custom': buttonRadius = brandControls.buttonCustomRadius.value + 'px'; break;
        default: buttonRadius = '9999px';
      }

      // Apply to all play buttons
      const allPlayButtons = document.querySelectorAll('.player-full__play, .player-pill__play');
      allPlayButtons.forEach(btn => {
        btn.style.backgroundColor = buttonColor;
        btn.style.borderColor = buttonBorderColor;
        btn.style.borderWidth = buttonBorderThickness;
        btn.style.borderStyle = buttonBorderThickness !== '0' ? 'solid' : 'none';
        btn.style.borderRadius = buttonRadius;
      });

      // Apply icon colors to all play buttons
      const allPlayIcons = document.querySelectorAll('.player-full__play-icon, .player-pill__play-icon');
      allPlayIcons.forEach(icon => {
        icon.style.color = iconColor;
      });

      // Mini player - apply all button settings from Brand Theme
      const miniPlayer = document.getElementById('mini-player');
      if (miniPlayer) {
        // Apply button shape - mini player uses 50% for pill/rounded to be circular
        let miniRadius;
        switch (brandControls.buttonShape.value) {
          case 'pill': miniRadius = '50%'; break;
          case 'rounded': miniRadius = '25%'; break;
          case 'square': miniRadius = '0'; break;
          case 'custom': miniRadius = brandControls.buttonCustomRadius.value + 'px'; break;
          default: miniRadius = '50%';
        }
        miniPlayer.style.borderRadius = miniRadius;

        // Apply button color
        miniPlayer.style.backgroundColor = buttonColor;

        // Apply button border
        if (buttonBorderThickness !== '0') {
          miniPlayer.style.borderColor = buttonBorderColor;
          miniPlayer.style.borderWidth = buttonBorderThickness;
          miniPlayer.style.borderStyle = 'solid';
        } else {
          miniPlayer.style.border = 'none';
        }

        // Apply icon colors
        miniPlayer.querySelectorAll('.player-mini__icon').forEach(icon => {
          icon.style.color = iconColor;
          icon.style.fill = iconColor;
        });

        // Apply progress ring colors via CSS custom properties
        const progressRing = miniPlayer.querySelector('.player-mini__progress-ring');
        if (progressRing) {
          progressRing.style.setProperty('--player-border', brandControls.border.value);
          progressRing.style.setProperty('--player-primary', buttonColor);
        }
      }

      // Apply same styling to example mini players
      const exampleMiniPlayers = document.querySelectorAll('.example-mini-player');
      exampleMiniPlayers.forEach(exMini => {
        // Apply button shape
        let miniRadius;
        switch (brandControls.buttonShape.value) {
          case 'pill': miniRadius = '50%'; break;
          case 'rounded': miniRadius = '25%'; break;
          case 'square': miniRadius = '0'; break;
          case 'custom': miniRadius = brandControls.buttonCustomRadius.value + 'px'; break;
          default: miniRadius = '50%';
        }
        exMini.style.borderRadius = miniRadius;

        // Apply button color
        exMini.style.backgroundColor = buttonColor;

        // Apply button border
        if (buttonBorderThickness !== '0') {
          exMini.style.borderColor = buttonBorderColor;
          exMini.style.borderWidth = buttonBorderThickness;
          exMini.style.borderStyle = 'solid';
        } else {
          exMini.style.border = 'none';
        }

        // Apply icon colors
        exMini.querySelectorAll('.player-mini__icon').forEach(icon => {
          icon.style.color = iconColor;
          icon.style.fill = iconColor;
        });

        // Apply progress ring colors
        const exProgressRing = exMini.querySelector('.player-mini__progress-ring');
        if (exProgressRing) {
          exProgressRing.style.setProperty('--player-border', brandControls.border.value);
          exProgressRing.style.setProperty('--player-primary', buttonColor);
        }
      });

      // Apply label color to all labels
      const allLabels = document.querySelectorAll('.player-full__transcript-label');
      allLabels.forEach(label => {
        label.style.color = labelColor;
      });

      // Apply link colors to all links (Show more, etc.)
      const allLinks = document.querySelectorAll('.player-full__transcript-more');
      allLinks.forEach(link => {
        link.style.color = linkColor;
        link.onmouseenter = () => link.style.color = linkHover;
        link.onmouseleave = () => link.style.color = linkColor;
      });
    }

    // Apply player shape to all player containers
    function applyPlayerShape() {
      // Calculate player radius based on shape
      let playerRadius;
      switch (brandControls.playerShape.value) {
        case 'pill': playerRadius = '9999px'; break;
        case 'rounded': playerRadius = '0.75rem'; break;
        case 'square': playerRadius = '0'; break;
        case 'custom': playerRadius = brandControls.playerCustomRadius.value + 'px'; break;
        default: playerRadius = '0.75rem';
      }

      // Apply to all player containers (not Mini - that's a button)
      const allPlayerContainers = document.querySelectorAll('.player-full, .player-pill');
      allPlayerContainers.forEach(container => {
        container.style.borderRadius = playerRadius;
      });
    }

    // Apply player padding to all player containers
    function applyPlayerPadding() {
      // Calculate padding value
      const paddingValues = { tight: '0.5rem', normal: '1rem', spacious: '1.5rem' };
      let playerPadding;
      if (brandControls.playerPadding.value === 'custom') {
        playerPadding = brandControls.playerCustomPadding.value + 'rem';
      } else {
        playerPadding = paddingValues[brandControls.playerPadding.value] || '1rem';
      }

      // Apply to Full player main area
      const fullMain = document.querySelector('.player-full__main');
      if (fullMain) {
        fullMain.style.padding = playerPadding;
      }

      // Note: Pill player has its own size-based padding, not global padding
    }

    // Apply player border thickness to all player containers
    function applyPlayerBorder() {
      const thickness = brandControls.playerBorderThickness.value;
      const borderColor = brandControls.border.value;

      // Apply to all player containers (not Mini - that's a button)
      const allPlayerContainers = document.querySelectorAll('.player-full, .player-pill');
      allPlayerContainers.forEach(container => {
        if (thickness === '0') {
          container.style.border = 'none';
        } else {
          container.style.border = `${thickness} solid ${borderColor}`;
        }
      });
    }

    // Apply waveform settings to all players
    function applyWaveformSettings() {
      const waveformType = brandControls.waveformType.value;
      const thicknessValue = brandControls.waveformThickness.value;
      const thicknessValues = { thin: 2, normal: 4, thick: 6 };
      const thickness = thicknessValues[thicknessValue] || 4;

      // Apply to Full player waveform
      const fullWaveform = document.getElementById('full-waveform-container');
      if (fullWaveform && waveformGenerators[waveformType]) {
        waveformGenerators[waveformType](fullWaveform);
        // Apply thickness after generating
        setTimeout(() => {
          fullWaveform.querySelectorAll('.player-full__wave-bar').forEach(bar => {
            bar.style.width = thickness + 'px';
          });
          fullWaveform.querySelectorAll('.player-full__wave-dot').forEach(dot => {
            dot.style.width = thickness + 'px';
            dot.style.height = thickness + 'px';
          });
        }, 10);
      }

      // Apply to Pill player waveform (only 7 bars for compact look)
      const pillWaveform = document.getElementById('pill-waveform-container');
      if (pillWaveform) {
        generateWaveformByType(pillWaveform, waveformType, thickness, 'pill', 7, 16);
      }

      // Initialize waveforms to inactive state after generation
      setTimeout(initializeWaveforms, 50);
    }

    // Apply show/hide settings for waveforms and timers, and time format
    function applyVisibilitySettings() {
      const showWaveform = brandControls.showWaveform.value === 'yes';
      const showTimer = brandControls.showTimer.value === 'yes';
      const timeFormat = brandControls.timeFormat.value;

      // All waveform containers
      const allWaveforms = document.querySelectorAll('.player-full__waveform, .player-pill__waveform');
      allWaveforms.forEach(wf => {
        wf.style.display = showWaveform ? '' : 'none';
      });

      // All timer elements
      const allTimers = document.querySelectorAll('.player-full__timer, .player-pill__timer');
      allTimers.forEach(timer => {
        timer.style.display = showTimer ? '' : 'none';
      });

      // Time format values for different players
      const timeFormats = {
        'elapsed-total': { full: '<span class="player-full__timer-current">0:00</span><span>/</span><span>1:00</span>', simple: '0:00 / 1:00' },
        'elapsed': { full: '0:00', simple: '0:00' },
        'remaining': { full: '-1:00', simple: '-1:00' },
        'seconds': { full: '0s', simple: '0s' },
        'mm-ss': { full: '00:00', simple: '00:00' },
        'total-only': { full: '1:00', simple: '1:00' }
      };

      const format = timeFormats[timeFormat] || timeFormats['elapsed-total'];

      // Apply to Full player timer
      const fullTimer = document.getElementById('full-timer');
      if (fullTimer) {
        fullTimer.innerHTML = format.full;
      }

      // Apply to Pill player timer
      const pillTimer = document.querySelector('.player-pill__timer');
      if (pillTimer) {
        pillTimer.textContent = format.simple;
      }
    }

    // Generate waveform by type for any player
    function generateWaveformByType(container, type, thickness, playerType, barCount, maxHeight) {
      const barClass = `player-${playerType}__wave-bar`;
      const dotClass = `player-${playerType}__wave-dot`;

      // Add both base class and type modifier class for animation detection
      container.className = `player-${playerType}__waveform player-full__waveform--${type}`;

      switch (type) {
        case 'bars':
          container.innerHTML = '';
          for (let i = 0; i < barCount; i++) {
            const bar = document.createElement('div');
            const height = Math.random() * maxHeight + 4;
            bar.className = barClass; // Start inactive
            bar.style.height = height + 'px';
            bar.style.width = thickness + 'px';
            container.appendChild(bar);
          }
          break;

        case 'smooth':
          container.innerHTML = `
            <svg viewBox="0 0 200 32" preserveAspectRatio="none" style="width:100%;height:${maxHeight}px;">
              <path class="waveform-smooth-bg" d="M0,16 C10,8 20,24 30,16 C40,8 50,24 60,16 C70,8 80,24 90,16 C100,8 110,24 120,16 C130,8 140,24 150,16 C160,8 170,24 180,16 C190,8 200,24 200,16" style="stroke-width:${thickness}"/>
              <path class="waveform-smooth-fill" d="M0,16 C10,8 20,24 30,16 C40,8 50,24 60,16 C70,8 80,24 90,16 C100,8 110,24 120,16 C130,8 140,24 150,16 C160,8 170,24 180,16 C190,8 200,24 200,16" style="stroke-width:${thickness}"/>
            </svg>
          `;
          break;

        case 'dots':
          container.innerHTML = '';
          for (let i = 0; i < barCount; i++) {
            const dot = document.createElement('div');
            dot.className = dotClass; // Start inactive
            dot.style.width = thickness + 'px';
            dot.style.height = thickness + 'px';
            container.appendChild(dot);
          }
          break;

        case 'line':
          container.innerHTML = `
            <svg viewBox="0 0 200 32" preserveAspectRatio="none" style="width:100%;height:${maxHeight}px;">
              <path class="waveform-line-bg" d="M0,16 L10,10 L20,20 L30,8 L40,22 L50,12 L60,18 L70,6 L80,24 L90,14 L100,16 L110,10 L120,22 L130,8 L140,20 L150,12 L160,18 L170,10 L180,22 L190,14 L200,16" style="stroke-width:${thickness}"/>
              <path class="waveform-line-fill" d="M0,16 L10,10 L20,20 L30,8 L40,22 L50,12 L60,18 L70,6 L80,24 L90,14 L100,16 L110,10 L120,22 L130,8 L140,20 L150,12 L160,18 L170,10 L180,22 L190,14 L200,16" style="stroke-width:${thickness}"/>
            </svg>
          `;
          break;

        case 'blob':
          container.innerHTML = `
            <svg viewBox="0 0 200 32" preserveAspectRatio="none" style="width:100%;height:${maxHeight}px;">
              <path class="blob-bg" d="M0,32 C5,32 5,28 10,28 C15,28 15,20 20,20 C25,20 25,24 30,24 C35,24 35,12 40,12 C45,12 45,18 50,18 C55,18 55,8 60,8 C65,8 65,22 70,22 C75,22 75,26 80,26 C85,26 85,14 90,14 C95,14 95,6 100,6 C105,6 105,16 110,16 C115,16 115,20 120,20 C125,20 125,10 130,10 C135,10 135,24 140,24 C145,24 145,18 150,18 C155,18 155,28 160,28 C165,28 165,22 170,22 C175,22 175,26 180,26 C185,26 185,30 190,30 C195,30 195,32 200,32 L200,32 L0,32 Z"/>
              <path class="blob-fill" d="M0,32 C5,32 5,28 10,28 C15,28 15,20 20,20 C25,20 25,24 30,24 C35,24 35,12 40,12 C45,12 45,18 50,18 C55,18 55,8 60,8 C65,8 65,22 70,22 C75,22 75,26 80,26 C85,26 85,14 90,14 C95,14 95,6 100,6 C105,6 105,16 110,16 C115,16 115,20 120,20 C125,20 125,10 130,10 C135,10 135,24 140,24 C145,24 145,18 150,18 C155,18 155,28 160,28 C165,28 165,22 170,22 C175,22 175,26 180,26 C185,26 185,30 190,30 C195,30 195,32 200,32 L200,32 L0,32 Z"/>
            </svg>
          `;
          break;

        case 'progress':
          container.innerHTML = `
            <div class="waveform-progress-track" style="height:${thickness}px;border-radius:${thickness/2}px;">
              <div class="waveform-progress-fill"></div>
            </div>
          `;
          break;

        default:
          // Default to bars
          container.innerHTML = '';
          for (let i = 0; i < barCount; i++) {
            const bar = document.createElement('div');
            const height = Math.random() * maxHeight + 4;
            bar.className = barClass; // Start inactive
            bar.style.height = height + 'px';
            bar.style.width = thickness + 'px';
            container.appendChild(bar);
          }
      }
    }

    // Adjust color brightness
    function adjustColor(hex, percent) {
      const num = parseInt(hex.slice(1), 16);
      const amt = Math.round(2.55 * percent);
      const R = Math.min(255, Math.max(0, (num >> 16) + amt));
      const G = Math.min(255, Math.max(0, (num >> 8 & 0x00FF) + amt));
      const B = Math.min(255, Math.max(0, (num & 0x0000FF) + amt));
      return '#' + (0x1000000 + R * 0x10000 + G * 0x100 + B).toString(16).slice(1);
    }

    // Add event listeners to brand controls (skip non-input elements like group containers)
    Object.values(brandControls).forEach(control => {
      if (control && control.tagName !== 'DIV') {
        control.addEventListener('input', updateBrandTheme);
        control.addEventListener('change', updateBrandTheme);
      }
    });

    // Toggle color input disabled state when transparent is checked
    brandControls.bgTransparent.addEventListener('change', () => {
      brandControls.bg.disabled = brandControls.bgTransparent.checked;
      brandControls.bg.parentElement.style.opacity = brandControls.bgTransparent.checked ? '0.5' : '1';
    });

    // Toggle button color input disabled state when transparent is checked
    brandControls.buttonTransparent.addEventListener('change', () => {
      brandControls.buttonColor.disabled = brandControls.buttonTransparent.checked;
      brandControls.buttonColor.parentElement.style.opacity = brandControls.buttonTransparent.checked ? '0.5' : '1';
    });

    // ============================================
    // SHARED CONTROLS SYNCING
    // ============================================
    // Sync shared controls across player panels - when one changes, update all others and the main control

    const sharedControlMappings = {
      'shared-brand-bg': { mainId: 'brand-bg', type: 'color' },
      'shared-brand-bg-transparent': { mainId: 'brand-bg-transparent', type: 'checkbox' },
      'shared-brand-border': { mainId: 'brand-border', type: 'color' },
      'shared-brand-player-border-thickness': { mainId: 'brand-player-border-thickness', type: 'select' },
      'shared-brand-player-shape': { mainId: 'brand-player-shape', type: 'select' },
      'shared-brand-text': { mainId: 'brand-text', type: 'color' },
      'shared-brand-text-secondary': { mainId: 'brand-text-secondary', type: 'color' },
      'shared-brand-button-color': { mainId: 'brand-button-color', type: 'color' },
      'shared-brand-button-transparent': { mainId: 'brand-button-transparent', type: 'checkbox' },
      'shared-brand-icon-color': { mainId: 'brand-icon-color', type: 'color' },
      'shared-brand-button-border-color': { mainId: 'brand-button-border-color', type: 'color' },
      'shared-brand-button-border-thickness': { mainId: 'brand-button-border-thickness', type: 'select' },
      'shared-brand-waveform-type': { mainId: 'brand-waveform-type', type: 'select' },
      'shared-brand-waveform-thickness': { mainId: 'brand-waveform-thickness', type: 'select' },
      'shared-brand-wave-active': { mainId: 'brand-wave-active', type: 'color' },
      'shared-brand-wave-inactive': { mainId: 'brand-wave-inactive', type: 'color' }
    };

    // Set up syncing for each shared control type
    Object.entries(sharedControlMappings).forEach(([className, config]) => {
      const sharedControls = document.querySelectorAll('.' + className);
      const mainControl = document.getElementById(config.mainId);

      if (!mainControl) return;

      sharedControls.forEach(control => {
        const eventType = config.type === 'checkbox' ? 'change' : 'input';

        control.addEventListener(eventType, () => {
          const value = config.type === 'checkbox' ? control.checked : control.value;

          // Update main control
          if (config.type === 'checkbox') {
            mainControl.checked = value;
          } else {
            mainControl.value = value;
          }

          // Update all other shared controls
          sharedControls.forEach(otherControl => {
            if (otherControl !== control) {
              if (config.type === 'checkbox') {
                otherControl.checked = value;
              } else {
                otherControl.value = value;
              }
              // Update color value display
              const valueDisplay = otherControl.parentElement?.querySelector('.color-value');
              if (valueDisplay && config.type === 'color') {
                valueDisplay.textContent = value.toUpperCase();
              }
            }
          });

          // Trigger main update
          updateBrandTheme();
        });

        // Also listen for change events on selects
        if (config.type === 'select') {
          control.addEventListener('change', () => {
            const value = control.value;
            mainControl.value = value;
            sharedControls.forEach(otherControl => {
              if (otherControl !== control) {
                otherControl.value = value;
              }
            });
            updateBrandTheme();
          });
        }
      });

      // Sync from main control to shared controls
      mainControl.addEventListener(config.type === 'checkbox' ? 'change' : 'input', () => {
        const value = config.type === 'checkbox' ? mainControl.checked : mainControl.value;
        sharedControls.forEach(control => {
          if (config.type === 'checkbox') {
            control.checked = value;
          } else {
            control.value = value;
          }
          // Update color value display
          const valueDisplay = control.parentElement?.querySelector('.color-value');
          if (valueDisplay && config.type === 'color') {
            valueDisplay.textContent = value.toUpperCase();
          }
        });
      });
    });

    // Initialize shared controls with values from main controls
    function syncSharedControlsFromMain() {
      Object.entries(sharedControlMappings).forEach(([className, config]) => {
        const sharedControls = document.querySelectorAll('.' + className);
        const mainControl = document.getElementById(config.mainId);

        if (!mainControl) return;

        const value = config.type === 'checkbox' ? mainControl.checked : mainControl.value;
        sharedControls.forEach(control => {
          if (config.type === 'checkbox') {
            control.checked = value;
          } else {
            control.value = value;
          }
          // Update color value display
          const valueDisplay = control.parentElement?.querySelector('.color-value');
          if (valueDisplay && config.type === 'color') {
            valueDisplay.textContent = value.toUpperCase();
          }
        });
      });
    }

    // Call on page load
    syncSharedControlsFromMain();

    // ============================================
    // FULL PLAYER OPTIONS
    // ============================================

    const fullControls = {
      transcriptBg: document.getElementById('full-transcript-bg'),
      showTranscript: document.getElementById('full-show-transcript'),
      showTranslation: document.getElementById('full-show-translation')
    };

    // Waveform generators
    const waveformGenerators = {
      bars: (container) => {
        container.className = 'player-full__waveform player-full__waveform--bars';
        // Use setTimeout to ensure container has width calculated
        setTimeout(() => {
          // Get current thickness setting from brand controls
          const thicknessSelect = brandControls.waveformThickness;
          const thicknessValues = { thin: 2, normal: 4, thick: 6 };
          const thickness = thicknessValues[thicknessSelect?.value] || 4;

          const containerWidth = container.offsetWidth || 300;
          const gap = 2;
          const numBars = Math.max(10, Math.floor((containerWidth + gap) / (thickness + gap)));

          container.innerHTML = '';
          for (let i = 0; i < numBars; i++) {
            const bar = document.createElement('div');
            const height = Math.random() * 16 + 4;
            bar.className = 'player-full__wave-bar'; // Start inactive
            bar.style.height = height + 'px';
            bar.style.width = thickness + 'px';
            bar.style.flexShrink = '0';
            container.appendChild(bar);
          }
        }, 0);
      },
      smooth: (container) => {
        container.className = 'player-full__waveform player-full__waveform--smooth';
        container.innerHTML = `
          <svg viewBox="0 0 200 32" preserveAspectRatio="none">
            <path class="waveform-smooth-bg" d="M0,16 C10,8 20,24 30,16 C40,8 50,24 60,16 C70,8 80,24 90,16 C100,8 110,24 120,16 C130,8 140,24 150,16 C160,8 170,24 180,16 C190,8 200,24 200,16"/>
            <path class="waveform-smooth-fill" d="M0,16 C10,8 20,24 30,16 C40,8 50,24 60,16 C70,8 80,24 90,16 C100,8 110,24 120,16 C130,8 140,24 150,16 C160,8 170,24 180,16 C190,8 200,24 200,16"/>
          </svg>
        `;
      },
      dots: (container) => {
        container.className = 'player-full__waveform player-full__waveform--dots';
        container.innerHTML = '';
        for (let i = 0; i < 25; i++) {
          const dot = document.createElement('div');
          const size = Math.random() * 6 + 4;
          dot.className = 'player-full__wave-dot'; // Start inactive
          dot.style.width = size + 'px';
          dot.style.height = size + 'px';
          container.appendChild(dot);
        }
      },
      line: (container) => {
        container.className = 'player-full__waveform player-full__waveform--line';
        container.innerHTML = `
          <svg viewBox="0 0 200 32" preserveAspectRatio="none">
            <path class="waveform-line-bg" d="M0,16 L10,10 L20,20 L30,8 L40,22 L50,12 L60,18 L70,6 L80,24 L90,14 L100,16 L110,10 L120,22 L130,8 L140,20 L150,12 L160,18 L170,10 L180,22 L190,14 L200,16"/>
            <path class="waveform-line-fill" d="M0,16 L10,10 L20,20 L30,8 L40,22 L50,12 L60,18 L70,6 L80,24 L90,14 L100,16 L110,10 L120,22 L130,8 L140,20 L150,12 L160,18 L170,10 L180,22 L190,14 L200,16"/>
          </svg>
        `;
      },
      blob: (container) => {
        container.className = 'player-full__waveform player-full__waveform--blob';
        container.innerHTML = `
          <svg viewBox="0 0 200 32" preserveAspectRatio="none">
            <path class="blob-bg" d="M0,32 C5,32 5,28 10,28 C15,28 15,20 20,20 C25,20 25,24 30,24 C35,24 35,12 40,12 C45,12 45,18 50,18 C55,18 55,8 60,8 C65,8 65,22 70,22 C75,22 75,26 80,26 C85,26 85,14 90,14 C95,14 95,6 100,6 C105,6 105,16 110,16 C115,16 115,20 120,20 C125,20 125,10 130,10 C135,10 135,24 140,24 C145,24 145,18 150,18 C155,18 155,28 160,28 C165,28 165,22 170,22 C175,22 175,26 180,26 C185,26 185,30 190,30 C195,30 195,32 200,32 L200,32 L0,32 Z"/>
            <path class="blob-fill" d="M0,32 C5,32 5,28 10,28 C15,28 15,20 20,20 C25,20 25,24 30,24 C35,24 35,12 40,12 C45,12 45,18 50,18 C55,18 55,8 60,8 C65,8 65,22 70,22 C75,22 75,26 80,26 C85,26 85,14 90,14 C95,14 95,6 100,6 C105,6 105,16 110,16 C115,16 115,20 120,20 C125,20 125,10 130,10 C135,10 135,24 140,24 C145,24 145,18 150,18 C155,18 155,28 160,28 C165,28 165,22 170,22 C175,22 175,26 180,26 C185,26 185,30 190,30 C195,30 195,32 200,32 L200,32 L0,32 Z"/>
          </svg>
        `;
      },
      progress: (container) => {
        container.className = 'player-full__waveform player-full__waveform--progress';
        container.innerHTML = `
          <div class="waveform-progress-track">
            <div class="waveform-progress-fill"></div>
          </div>
        `;
      }
    };

    function updateFullPlayer() {
      const player = document.getElementById('preview-full');

      // Player shape, padding, border, and time format are now handled globally

      // Show/hide transcript
      const transcriptSection = document.getElementById('transcript-section');
      transcriptSection.style.display = fullControls.showTranscript.value === 'yes' ? '' : 'none';

      // Show/hide translation
      const translationSection = document.getElementById('translation-section');
      translationSection.style.display = fullControls.showTranslation.value === 'yes' ? '' : 'none';

      // Transcript background color
      player.querySelectorAll('.player-full__transcript-section').forEach(el => {
        el.style.backgroundColor = fullControls.transcriptBg.value;
      });

      // Update transcript bg color value display
      document.getElementById('full-transcript-bg-value').textContent = fullControls.transcriptBg.value.toUpperCase();
    }

    // Transcript background color input
    fullControls.transcriptBg.addEventListener('input', updateFullPlayer);

    // Show more/less toggle for transcript and translation
    document.querySelectorAll('.player-full__transcript-more').forEach(link => {
      link.addEventListener('click', function(e) {
        e.preventDefault();
        const textEl = this.previousElementSibling;
        const isExpanded = textEl.classList.toggle('is-expanded');
        this.textContent = isExpanded ? this.dataset.expanded : this.dataset.collapsed;
      });
    });

    // Event listeners for all full player controls
    [fullControls.borderWidth, fullControls.padding,
     fullControls.paddingCustom, fullControls.time, fullControls.showTranscript,
     fullControls.showTranslation].forEach(control => {
      if (control) control.addEventListener('change', updateFullPlayer);
    });

    // Initialize full player
    updateFullPlayer();
    // Initialize waveform bars after player setup (needs container width to be calculated)
    setTimeout(regenerateWaveformBars, 50);

    // ============================================
    // MINI PLAYER OPTIONS
    // ============================================

    const miniControls = {
      size: document.getElementById('mini-size'),
      position: document.getElementById('mini-position'),
      animation: document.getElementById('mini-animation')
    };

    // Track mini player state globally
    let miniProgressAnimation = null;
    let miniProgressAngle = 0;
    let miniIsPlaying = false;

    function updateMiniPlayer() {
      const player = document.getElementById('mini-player');
      const progressRing = player.querySelector('.player-mini__progress-ring');

      // Reset all modifier classes (keep base class)
      player.className = 'player-mini';

      // Apply size class
      player.classList.add(`player-mini--${miniControls.size.value}`);

      // Apply position class
      player.classList.add(`player-mini--${miniControls.position.value}`);

      // Restore playing state from global flag
      if (miniIsPlaying) {
        player.classList.add('is-playing');
      }

      // Handle animation setting
      if (progressRing) {
        // Reset animation classes
        player.classList.remove('player-mini--pulse', 'player-mini--rings');

        if (miniControls.animation.value === 'circular') {
          progressRing.classList.remove('hidden');
        } else if (miniControls.animation.value === 'pulse') {
          progressRing.classList.add('hidden');
          player.classList.add('player-mini--pulse');
        } else if (miniControls.animation.value === 'rings') {
          progressRing.classList.add('hidden');
          player.classList.add('player-mini--rings');
        } else {
          progressRing.classList.add('hidden');
        }
      }

      // Button/icon colors and shape come from general Brand Theme options
      applyButtonColors();
    }

    // Listen to all controls
    [miniControls.size, miniControls.position, miniControls.animation].forEach(control => {
      if (control) control.addEventListener('change', updateMiniPlayer);
    });

    // Initialize mini player
    updateMiniPlayer();

    let miniPulseTimeout = null;

    function resetMiniPlayer(player, playIcon, pauseIcon, progressFill) {
      miniIsPlaying = false;
      player.classList.remove('is-playing');
      if (playIcon) playIcon.style.display = 'block';
      if (pauseIcon) pauseIcon.style.display = 'none';

      // Clear circular animation
      if (miniProgressAnimation) {
        cancelAnimationFrame(miniProgressAnimation);
        miniProgressAnimation = null;
      }
      miniProgressAngle = 0;
      if (progressFill) {
        const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--player-primary').trim() || '#3B82F6';
        progressFill.style.background = `conic-gradient(${primaryColor} 0deg, transparent 0deg)`;
      }

      // Clear pulse timeout
      if (miniPulseTimeout) {
        clearTimeout(miniPulseTimeout);
        miniPulseTimeout = null;
      }
    }

    window.toggleMiniPlayer = function(e, player) {
      e.stopPropagation();

      const animationType = miniControls.animation.value;
      const playIcon = player.querySelector('.player-mini__icon--play');
      const pauseIcon = player.querySelector('.player-mini__icon--pause');
      const progressRing = player.querySelector('.player-mini__progress-ring');
      const progressFill = player.querySelector('.player-mini__progress-fill');

      // If currently playing, stop everything
      if (miniIsPlaying) {
        resetMiniPlayer(player, playIcon, pauseIcon, progressFill);
        return;
      }

      // Start playing
      miniIsPlaying = true;
      player.classList.add('is-playing');
      if (playIcon) playIcon.style.display = 'none';
      if (pauseIcon) pauseIcon.style.display = 'block';

      // Handle circular progress animation
      if (animationType === 'circular' && progressFill && progressRing) {
        progressRing.classList.remove('hidden');
        miniProgressAngle = 0;
        const primaryColor = getComputedStyle(document.documentElement).getPropertyValue('--player-primary').trim() || '#3B82F6';

        const animate = () => {
          if (!miniIsPlaying) return;
          miniProgressAngle += 0.1;

          if (miniProgressAngle >= 360) {
            resetMiniPlayer(player, playIcon, pauseIcon, progressFill);
            return;
          }

          progressFill.style.background = `conic-gradient(${primaryColor} ${miniProgressAngle}deg, transparent ${miniProgressAngle}deg)`;
          miniProgressAnimation = requestAnimationFrame(animate);
        };
        miniProgressAnimation = requestAnimationFrame(animate);

      // Handle pulse animation
      } else if (animationType === 'pulse') {
        // Make sure pulse class is on the player
        player.classList.add('player-mini--pulse');

        // Set 60 second timeout to stop the animation
        miniPulseTimeout = setTimeout(() => {
          resetMiniPlayer(player, playIcon, pauseIcon, progressFill);
        }, 60000);

      // Handle rings animation
      } else if (animationType === 'rings') {
        // Make sure rings class is on the player
        player.classList.add('player-mini--rings');

        // Set 60 second timeout to stop the animation
        miniPulseTimeout = setTimeout(() => {
          resetMiniPlayer(player, playIcon, pauseIcon, progressFill);
        }, 60000);
      }
      // For 'none' animation type, just toggle play state (already done above)
    };

    // ============================================
    // PILL PLAYER OPTIONS
    // ============================================

    const pillControls = {
      size: document.getElementById('pill-size'),
      customSize: document.getElementById('pill-custom-size'),
      customSizeGroup: document.getElementById('pill-custom-size-group'),
      customSizeValue: document.getElementById('pill-custom-size-value')
    };

    function updatePillPlayer() {
      const player = document.getElementById('preview-pill');
      const playBtn = player.querySelector('.player-pill__play');
      const timer = player.querySelector('.player-pill__timer');
      const waveform = player.querySelector('.player-pill__waveform');

      // Show/hide custom size slider
      pillControls.customSizeGroup.style.display = pillControls.size.value === 'custom' ? '' : 'none';

      // Update custom slider display
      pillControls.customSizeValue.textContent = pillControls.customSize.value + 'px';

      // Size presets matching the original CSS classes
      const sizeStyles = {
        xs: { height: '1.75rem', padding: '0.125rem 0.375rem 0.125rem 0.125rem', btnSize: '1.375rem', fontSize: '0.5rem', gap: '0.25rem', waveHeight: '0.625rem', iconSize: '0.4rem' },
        sm: { height: '2.25rem', padding: '0.25rem 0.5rem 0.25rem 0.25rem', btnSize: '1.75rem', fontSize: '0.5625rem', gap: '0.375rem', waveHeight: '0.875rem', iconSize: '0.5rem' },
        md: { height: '2.75rem', padding: '0.375rem 0.625rem 0.375rem 0.375rem', btnSize: '2rem', fontSize: '0.625rem', gap: '0.5rem', waveHeight: '1rem', iconSize: '0.625rem' },
        lg: { height: '3.5rem', padding: '0.5rem 0.75rem 0.5rem 0.5rem', btnSize: '2.5rem', fontSize: '0.6875rem', gap: '0.625rem', waveHeight: '1.25rem', iconSize: '0.75rem' },
        custom: null
      };

      let style;
      if (pillControls.size.value === 'custom') {
        const h = parseInt(pillControls.customSize.value);
        const scale = h / 44;
        style = {
          height: h + 'px',
          padding: `${Math.round(6 * scale)}px ${Math.round(14 * scale)}px ${Math.round(6 * scale)}px ${Math.round(6 * scale)}px`,
          btnSize: Math.round(32 * scale) + 'px',
          fontSize: Math.max(9, Math.round(11 * scale)) + 'px',
          gap: Math.round(10 * scale) + 'px',
          waveHeight: Math.round(20 * scale) + 'px',
          iconSize: Math.max(8, Math.round(12 * scale)) + 'px'
        };
      } else {
        style = sizeStyles[pillControls.size.value] || sizeStyles.md;
      }

      // Apply styles
      player.style.height = style.height;
      player.style.padding = style.padding;
      player.style.gap = style.gap;
      player.style.width = 'auto';

      playBtn.style.width = style.btnSize;
      playBtn.style.height = style.btnSize;
      playBtn.style.minWidth = style.btnSize;
      playBtn.style.fontSize = style.iconSize;

      timer.style.fontSize = style.fontSize;

      if (waveform) {
        waveform.style.height = style.waveHeight;
      }

      // Waveform is handled globally via applyWaveformSettings()
    }

    pillControls.size.addEventListener('change', updatePillPlayer);
    pillControls.customSize.addEventListener('input', updatePillPlayer);

    // Initialize pill player
    updatePillPlayer();

    // ============================================
    // RESPONSIVE PREVIEW
    // ============================================

    const responsiveContainer = document.getElementById('responsive-container');
    const responsiveContent = document.getElementById('responsive-content');
    const responsiveHandle = document.getElementById('responsive-handle');
    const responsiveWidthValue = document.getElementById('responsive-width-value');
    const responsiveRuler = document.getElementById('responsive-ruler');
    const responsiveIndicator = document.getElementById('responsive-indicator');

    if (responsiveContainer && responsiveHandle) {
      let isDragging = false;
      let startX = 0;
      let startWidth = 0;

      // Ruler max for scaling (xl at 1200, with room for label)
      const RULER_MAX = 1240;

      // Position breakpoints on the ruler
      const updateRuler = () => {
        const rulerWidth = responsiveRuler.offsetWidth;
        const bpElements = responsiveRuler.querySelectorAll('.responsive-preview__breakpoint');
        const bpPositions = [0, 480, 768, 1024, 1200];

        bpElements.forEach((el, index) => {
          const position = bpPositions[index];
          const scaledPosition = (position / RULER_MAX) * rulerWidth;
          el.style.left = `${scaledPosition}px`;
        });
      };

      // Update indicator to show current width
      const updateIndicator = (currentWidth) => {
        const rulerWidth = responsiveRuler.offsetWidth;
        const scaledWidth = (currentWidth / RULER_MAX) * rulerWidth;
        responsiveIndicator.style.width = `${scaledWidth}px`;
      };

      // Update width display
      const updateWidthDisplay = (width) => {
        const remWidth = (width / 16).toFixed(2);
        responsiveWidthValue.textContent = `${Math.round(width)}px / ${remWidth}rem`;
      };

      // Set width and update everything
      const setWidth = (pxWidth) => {
        responsiveContainer.style.width = pxWidth + 'px';
        responsiveContainer.style.maxWidth = pxWidth + 'px';
        updateWidthDisplay(pxWidth);
        updateIndicator(pxWidth);
        requestAnimationFrame(() => regenerateWaveformBars());
      };

      // Breakpoint clicks
      document.querySelectorAll('.responsive-preview__breakpoint').forEach(bp => {
        bp.addEventListener('click', () => {
          const pxWidth = parseInt(bp.dataset.width);
          responsiveContainer.style.transition = 'width 0.3s ease';
          setWidth(pxWidth);
        });
      });

      // Drag to resize
      let lastWidth = 1200;

      responsiveHandle.addEventListener('mousedown', (e) => {
        isDragging = true;
        startX = e.clientX;
        startWidth = responsiveContainer.offsetWidth;
        document.body.style.cursor = 'ew-resize';
        document.body.style.userSelect = 'none';
      });

      document.addEventListener('mousemove', (e) => {
        if (!isDragging) return;

        const diff = e.clientX - startX;
        const newWidth = Math.max(320, Math.min(startWidth + diff, 1200));

        responsiveContainer.style.width = newWidth + 'px';
        responsiveContainer.style.maxWidth = newWidth + 'px';
        responsiveContainer.style.transition = 'none';

        updateWidthDisplay(newWidth);
        updateIndicator(newWidth);

        // Update waveform when width changes by 7px (one bar slot)
        if (Math.abs(newWidth - lastWidth) >= 7) {
          regenerateWaveformBars();
          lastWidth = newWidth;
        }
      });

      document.addEventListener('mouseup', () => {
        if (isDragging) {
          isDragging = false;
          document.body.style.cursor = '';
          document.body.style.userSelect = '';
          responsiveContainer.style.transition = 'width 0.3s ease';
          requestAnimationFrame(() => regenerateWaveformBars());
          lastWidth = responsiveContainer.offsetWidth;
        }
      });

      // Initialize ruler and indicator
      window.addEventListener('resize', () => {
        updateRuler();
        updateIndicator(responsiveContainer.offsetWidth);
      });

      // Initial setup
      setTimeout(() => {
        updateRuler();
        setWidth(1200);
      }, 100);
    }

    // Function to regenerate waveform bars based on container width
    function regenerateWaveformBars() {
      const waveformContainer = document.getElementById('full-waveform-container');
      if (!waveformContainer || !waveformContainer.classList.contains('player-full__waveform--bars')) return;

      // Get current thickness setting from brand controls
      const thicknessValues = { thin: 2, normal: 4, thick: 6 };
      const thickness = thicknessValues[brandControls.waveformThickness?.value] || 4;

      const containerWidth = waveformContainer.offsetWidth;
      const gap = 2;
      const numBars = Math.max(10, Math.floor((containerWidth + gap) / (thickness + gap)));

      waveformContainer.innerHTML = '';
      for (let i = 0; i < numBars; i++) {
        const bar = document.createElement('div');
        const height = Math.random() * 16 + 4;
        bar.className = 'player-full__wave-bar'; // Start inactive
        bar.style.height = height + 'px';
        bar.style.width = thickness + 'px';
        bar.style.flexShrink = '0';
        waveformContainer.appendChild(bar);
      }
    }

    // ============================================
    // WAVEFORM ANIMATION
    // ============================================

    let waveformAnimations = {};

    // Format seconds to m:ss
    function formatTime(seconds) {
      const mins = Math.floor(seconds / 60);
      const secs = Math.floor(seconds % 60);
      return `${mins}:${secs.toString().padStart(2, '0')}`;
    }

    // Get timer format from brand controls
    function getTimerFormat() {
      return brandControls.timeFormat?.value || 'elapsed-total';
    }

    // Detect waveform type from container classes
    function getWaveformType(container) {
      if (!container) return 'bars';
      if (container.classList.contains('player-full__waveform--smooth')) return 'smooth';
      if (container.classList.contains('player-full__waveform--line')) return 'line';
      if (container.classList.contains('player-full__waveform--blob')) return 'blob';
      if (container.classList.contains('player-full__waveform--progress')) return 'progress';
      if (container.classList.contains('player-full__waveform--dots')) return 'dots';
      return 'bars';
    }

    function animateWaveform(playerType, waveformContainer, barClass, playButton, player, timerElement, totalDuration = 60) {
      if (!waveformContainer) return;

      const animationId = playerType;
      const totalDurationMs = totalDuration * 1000;
      const waveformType = getWaveformType(waveformContainer);

      // Reset timer to 0
      if (timerElement) {
        updateTimerDisplay(timerElement, 0, totalDuration, playerType);
      }

      // Handle different waveform types
      if (waveformType === 'bars' || waveformType === 'dots') {
        // Bar/Dot-based animation - detect the correct class
        const elementClass = waveformType === 'dots' ? barClass.replace('wave-bar', 'wave-dot') : barClass;
        const bars = waveformContainer.querySelectorAll('.' + elementClass);
        if (bars.length === 0) return;

        let currentBar = 0;
        const delayPerBar = totalDurationMs / bars.length;
        const timePerBar = totalDuration / bars.length;

        // Reset all bars to inactive
        bars.forEach(bar => bar.classList.remove('is-active'));

        const animate = () => {
          if (!waveformAnimations[animationId]) return;

          if (currentBar < bars.length) {
            bars[currentBar].classList.add('is-active');
            currentBar++;
            const elapsedTime = currentBar * timePerBar;

            if (timerElement) {
              updateTimerDisplay(timerElement, elapsedTime, totalDuration, playerType);
            }

            waveformAnimations[animationId] = setTimeout(animate, delayPerBar);
          } else {
            stopWaveformAnimation(playerType, waveformContainer, barClass, playButton, player, timerElement, totalDuration);
          }
        };

        waveformAnimations[animationId] = setTimeout(animate, delayPerBar);

      } else if (waveformType === 'smooth' || waveformType === 'line') {
        // SVG stroke-dashoffset animation
        const fillClass = waveformType === 'smooth' ? '.waveform-smooth-fill' : '.waveform-line-fill';
        const fillPath = waveformContainer.querySelector(fillClass);
        if (!fillPath) return;

        // Get the path length for accurate animation
        const pathLength = fillPath.getTotalLength ? fillPath.getTotalLength() : 200;
        fillPath.style.strokeDasharray = pathLength;
        fillPath.style.strokeDashoffset = pathLength; // Start hidden

        let startTime = null;
        const animate = (timestamp) => {
          if (!waveformAnimations[animationId]) return;
          if (!startTime) startTime = timestamp;

          const elapsed = timestamp - startTime;
          const progress = Math.min(elapsed / totalDurationMs, 1);
          const offset = pathLength * (1 - progress);

          fillPath.style.strokeDashoffset = offset;

          if (timerElement) {
            updateTimerDisplay(timerElement, progress * totalDuration, totalDuration, playerType);
          }

          if (progress < 1) {
            waveformAnimations[animationId] = requestAnimationFrame(animate);
          } else {
            stopWaveformAnimation(playerType, waveformContainer, barClass, playButton, player, timerElement, totalDuration);
          }
        };

        waveformAnimations[animationId] = requestAnimationFrame(animate);

      } else if (waveformType === 'blob') {
        // Blob uses clip-path animation
        const blobFill = waveformContainer.querySelector('.blob-fill');
        if (!blobFill) return;

        blobFill.style.clipPath = 'inset(0 100% 0 0)'; // Start hidden

        let startTime = null;
        const animate = (timestamp) => {
          if (!waveformAnimations[animationId]) return;
          if (!startTime) startTime = timestamp;

          const elapsed = timestamp - startTime;
          const progress = Math.min(elapsed / totalDurationMs, 1);
          const clipRight = 100 - (progress * 100);

          blobFill.style.clipPath = `inset(0 ${clipRight}% 0 0)`;

          if (timerElement) {
            updateTimerDisplay(timerElement, progress * totalDuration, totalDuration, playerType);
          }

          if (progress < 1) {
            waveformAnimations[animationId] = requestAnimationFrame(animate);
          } else {
            stopWaveformAnimation(playerType, waveformContainer, barClass, playButton, player, timerElement, totalDuration);
          }
        };

        waveformAnimations[animationId] = requestAnimationFrame(animate);

      } else if (waveformType === 'progress') {
        // Progress bar width animation
        const progressFill = waveformContainer.querySelector('.waveform-progress-fill');
        if (!progressFill) return;

        progressFill.style.width = '0%'; // Start at 0

        let startTime = null;
        const animate = (timestamp) => {
          if (!waveformAnimations[animationId]) return;
          if (!startTime) startTime = timestamp;

          const elapsed = timestamp - startTime;
          const progress = Math.min(elapsed / totalDurationMs, 1);

          progressFill.style.width = `${progress * 100}%`;

          if (timerElement) {
            updateTimerDisplay(timerElement, progress * totalDuration, totalDuration, playerType);
          }

          if (progress < 1) {
            waveformAnimations[animationId] = requestAnimationFrame(animate);
          } else {
            stopWaveformAnimation(playerType, waveformContainer, barClass, playButton, player, timerElement, totalDuration);
          }
        };

        waveformAnimations[animationId] = requestAnimationFrame(animate);
      }
    }

    function updateTimerDisplay(timerElement, elapsed, total, playerType) {
      const format = getTimerFormat();
      const remaining = total - elapsed;

      let displayText = '';
      switch (format) {
        case 'elapsed-total':
          if (playerType === 'full') {
            timerElement.innerHTML = `<span class="player-full__timer-current">${formatTime(elapsed)}</span><span>/</span><span>${formatTime(total)}</span>`;
          } else {
            displayText = `${formatTime(elapsed)} / ${formatTime(total)}`;
            timerElement.textContent = displayText;
          }
          break;
        case 'elapsed':
          if (playerType === 'full') {
            timerElement.innerHTML = `<span class="player-full__timer-current">${formatTime(elapsed)}</span>`;
          } else {
            timerElement.textContent = formatTime(elapsed);
          }
          break;
        case 'remaining':
          if (playerType === 'full') {
            timerElement.innerHTML = `<span class="player-full__timer-current">-${formatTime(remaining)}</span>`;
          } else {
            timerElement.textContent = `-${formatTime(remaining)}`;
          }
          break;
        case 'total':
          if (playerType === 'full') {
            timerElement.innerHTML = `<span class="player-full__timer-current">${formatTime(total)}</span>`;
          } else {
            timerElement.textContent = formatTime(total);
          }
          break;
        default:
          if (playerType === 'full') {
            timerElement.innerHTML = `<span class="player-full__timer-current">${formatTime(elapsed)}</span><span>/</span><span>${formatTime(total)}</span>`;
          } else {
            timerElement.textContent = `${formatTime(elapsed)} / ${formatTime(total)}`;
          }
      }
    }

    function stopWaveformAnimation(playerType, waveformContainer, barClass, playButton, player, timerElement, totalDuration = 60) {
      const animationId = playerType;

      // Clear any pending timeout or animation frame
      if (waveformAnimations[animationId]) {
        clearTimeout(waveformAnimations[animationId]);
        cancelAnimationFrame(waveformAnimations[animationId]);
        waveformAnimations[animationId] = null;
      }

      // Reset waveform based on type
      if (waveformContainer) {
        const waveformType = getWaveformType(waveformContainer);

        if (waveformType === 'bars' || waveformType === 'dots') {
          // Reset bars/dots to inactive - detect the correct class
          const elementClass = waveformType === 'dots' ? barClass.replace('wave-bar', 'wave-dot') : barClass;
          const bars = waveformContainer.querySelectorAll('.' + elementClass);
          bars.forEach(bar => bar.classList.remove('is-active'));

        } else if (waveformType === 'smooth') {
          // Reset smooth SVG
          const fillPath = waveformContainer.querySelector('.waveform-smooth-fill');
          if (fillPath) {
            const pathLength = fillPath.getTotalLength ? fillPath.getTotalLength() : 200;
            fillPath.style.strokeDasharray = pathLength;
            fillPath.style.strokeDashoffset = pathLength;
          }

        } else if (waveformType === 'line') {
          // Reset line SVG
          const fillPath = waveformContainer.querySelector('.waveform-line-fill');
          if (fillPath) {
            const pathLength = fillPath.getTotalLength ? fillPath.getTotalLength() : 200;
            fillPath.style.strokeDasharray = pathLength;
            fillPath.style.strokeDashoffset = pathLength;
          }

        } else if (waveformType === 'blob') {
          // Reset blob clip-path
          const blobFill = waveformContainer.querySelector('.blob-fill');
          if (blobFill) {
            blobFill.style.clipPath = 'inset(0 100% 0 0)';
          }

        } else if (waveformType === 'progress') {
          // Reset progress bar
          const progressFill = waveformContainer.querySelector('.waveform-progress-fill');
          if (progressFill) {
            progressFill.style.width = '0%';
          }
        }
      }

      // Reset timer to 0
      if (timerElement) {
        updateTimerDisplay(timerElement, 0, totalDuration, playerType);
      }

      // Reset player state
      if (player) {
        player.classList.remove('is-playing');
      }

      // Reset play icon
      if (playButton) {
        const playIcon = playButton.querySelector('[class*="play-icon"]');
        if (playIcon) {
          playIcon.classList.remove('fa-pause');
          playIcon.classList.add('fa-play');
        }
      }
    }

    // ============================================
    // PLAY BUTTON INTERACTIONS
    // ============================================

    // Full player play button
    const fullPlayBtn = document.querySelector('#preview-full .player-full__play');
    if (fullPlayBtn) {
      fullPlayBtn.addEventListener('click', function() {
        const player = document.getElementById('preview-full');
        const isPlaying = player.classList.toggle('is-playing');
        const waveform = player.querySelector('.player-full__waveform');
        const timer = player.querySelector('.player-full__timer');

        // Toggle play/pause icon
        const playIcon = this.querySelector('.player-full__play-icon');
        if (playIcon) {
          playIcon.classList.toggle('fa-play', !isPlaying);
          playIcon.classList.toggle('fa-pause', isPlaying);
        }

        if (isPlaying) {
          animateWaveform('full', waveform, 'player-full__wave-bar', this, player, timer, 60);
        } else {
          stopWaveformAnimation('full', waveform, 'player-full__wave-bar', this, player, timer, 60);
        }
      });
    }

    // Pill player play button
    const pillPlayBtn = document.querySelector('#preview-pill .player-pill__play');
    if (pillPlayBtn) {
      pillPlayBtn.addEventListener('click', function() {
        const player = document.getElementById('preview-pill');
        const isPlaying = player.classList.toggle('is-playing');
        const waveform = player.querySelector('.player-pill__waveform');
        const timer = player.querySelector('.player-pill__timer');

        // Toggle play/pause icon
        const playIcon = this.querySelector('.player-pill__play-icon');
        if (playIcon) {
          playIcon.classList.toggle('fa-play', !isPlaying);
          playIcon.classList.toggle('fa-pause', isPlaying);
        }

        if (isPlaying) {
          animateWaveform('pill', waveform, 'player-pill__wave-bar', this, player, timer, 60);
        } else {
          stopWaveformAnimation('pill', waveform, 'player-pill__wave-bar', this, player, timer, 60);
        }
      });
    }

    // Ensure all settings are applied after full page load
    // Initialize all waveforms to inactive state
    function initializeWaveforms() {
      // Reset all SVG stroke-based waveforms
      document.querySelectorAll('.waveform-smooth-fill, .waveform-line-fill').forEach(fill => {
        const pathLength = fill.getTotalLength ? fill.getTotalLength() : 200;
        fill.style.strokeDasharray = pathLength;
        fill.style.strokeDashoffset = pathLength;
      });

      // Reset all blob clip-paths
      document.querySelectorAll('.blob-fill').forEach(blob => {
        blob.style.clipPath = 'inset(0 100% 0 0)';
      });

      // Reset all progress fills
      document.querySelectorAll('.waveform-progress-fill').forEach(fill => {
        fill.style.width = '0%';
      });

      // Reset all bar/dot active states
      document.querySelectorAll('.player-full__wave-bar, .player-full__wave-dot, .player-pill__wave-bar, .player-pill__wave-dot').forEach(el => {
        el.classList.remove('is-active');
      });
    }

    // Initialize example waveforms with bars
    function initializeExampleWaveforms() {
      // Initialize Full player example waveforms
      document.querySelectorAll('.example-waveform').forEach(container => {
        const containerWidth = container.offsetWidth || 150;
        const thickness = 3;
        const gap = 2;
        const numBars = Math.max(8, Math.floor((containerWidth + gap) / (thickness + gap)));

        container.innerHTML = '';
        for (let i = 0; i < numBars; i++) {
          const bar = document.createElement('div');
          const height = Math.random() * 14 + 4;
          bar.className = 'player-full__wave-bar';
          bar.style.height = height + 'px';
          bar.style.width = thickness + 'px';
          bar.style.flexShrink = '0';
          container.appendChild(bar);
        }
      });

      // Initialize Pill player example waveforms
      document.querySelectorAll('.example-waveform-pill').forEach(container => {
        const containerWidth = container.offsetWidth || 80;
        const thickness = 2;
        const gap = 2;
        const numBars = Math.max(6, Math.floor((containerWidth + gap) / (thickness + gap)));

        container.innerHTML = '';
        for (let i = 0; i < numBars; i++) {
          const bar = document.createElement('div');
          const height = Math.random() * 10 + 3;
          bar.className = 'player-pill__wave-bar';
          bar.style.height = height + 'px';
          bar.style.width = thickness + 'px';
          bar.style.flexShrink = '0';
          container.appendChild(bar);
        }
      });
    }

    window.addEventListener('load', () => {
      updateBrandTheme();
      regenerateWaveformBars();
      // Initialize waveforms after a short delay to ensure they're rendered
      setTimeout(initializeWaveforms, 100);
      // Initialize example waveforms
      setTimeout(initializeExampleWaveforms, 150);
    });
  </script>
</body>
</html>
